<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with the metapopbio package • metapopbio</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with the metapopbio package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metapopbio</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting started with the metapopbio package</a></li>
    <li><a class="dropdown-item" href="../articles/using-auto.spmm.html">Using auto.spmm</a></li>
    <li><a class="dropdown-item" href="../articles/using-spmm.readxl.html">Using the spmm.readxl funciton</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AldridgeCaleb/meta-pop-bio/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting started with the metapopbio package</h1>
                        <h4 data-toc-skip class="author">Caleb A.
Aldridge</h4>
            
            <h4 data-toc-skip class="date">2025-07-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AldridgeCaleb/meta-pop-bio/blob/main/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github("AldridgeCaleb/meta-pop-bio")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aldridgecaleb.github.io/meta-pop-bio/">metapopbio</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: openxlsx</span></span>
<span><span class="co">#&gt; Loading required package: zeallot</span></span></code></pre></div>
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>The <a href="https://github.com/AldridgeCaleb/meta-pop-bio" class="external-link"><code>metapopbio</code></a>
package is inspired by and complements the functionalities of the <a href="https://cran.r-project.org/web/packages/popbio/index.html" class="external-link"><code>popbio</code></a>
package. Users can construct and analyze projection matrix models for
metapopulations classified by age or stage and located in distinct
patches.</p>
<p>The functionality to date is largely based on Hunter and Caswell
(2005) to construct and analyze spatial matrix population models using
the vec-permutation matrix. This model extends the Leslie matrix (Leslie
1945) to include dispersal rates between patches. An analogous approach
was taken by Lebreton (1996) and called the “renewal equation
approach.”</p>
<p>Current plans include support for classic metapopulation models of
Gotelli (1991; 2008) <em>and others</em>, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi>p</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>p</mi><mi>e</mi></msub><mi>f</mi></mrow><annotation encoding="application/x-tex">\frac{df}{dt}=p_{i}(1-f)-p_{e}f</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi>p</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>e</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{df}{dt}=p_{i}(1-f)-ef(1-f)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>i</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>p</mi><mi>e</mi></msub><mi>f</mi></mrow><annotation encoding="application/x-tex">\frac{df}{dt}=if(1-f)-p_{e}f</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>i</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>e</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{df}{dt}=if(1-f)-ef(1-f)</annotation></semantics></math>,
and hyperstate matrix models (Roth and Caswell 2016). Additionally,
Hanski’s (1994) incidence function <span class="math inline">$J_{i}=\frac{1}{1+\Bigl(1+\bigl[\frac{y'}{S_{i}}\bigr]^2\Bigr)\frac{e}{A_{i}^x}}$</span>
and a metapopulation version of the
<strong>S</strong>usceptible–<strong>I</strong>nfected–<strong>R</strong>ecovered
model (SIR model), also referred to as a patch model, are also being
considered. Other suggestions can be submitted in email to <a href="mailto:caleb.a.aldridge@gmail.com" class="email">caleb.a.aldridge@gmail.com</a> or as an issue on the
package’s GitHub repository (<a href="https://github.com/AldridgeCaleb/meta-pop-bio/issues" class="external-link uri">https://github.com/AldridgeCaleb/meta-pop-bio/issues</a>).</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The following two examples come from Hunter and Caswell (2005) using
peregrine falcon (<em>Falco peregrinus</em>) data from Wootton and Bell
(1992) and black-headed gull (<em>Larus ridibundus</em>) data from
Lebreton (1996).</p>
<div class="section level3">
<h3 id="the-peregrine-falcon">The peregrine falcon<a class="anchor" aria-label="anchor" href="#the-peregrine-falcon"></a>
</h3>
<div class="section level5">
<h5 id="patches-stages-and-grouping">1. Patches, stages, and grouping<a class="anchor" aria-label="anchor" href="#patches-stages-and-grouping"></a>
</h5>
<p>First, we define the number of patches (discrete locations) and
stages (age, class, or size). In this example there are two “patches”,
Northern California and Southern California, and two life-stages,
juvenile and adult. We also group or will project stages within
patches<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;If we were to group or project patches within stages,
the groupby object would contain “stages”.&lt;/p&gt;"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_patches</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">n_stages</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-vec-permutation-matrix">2. Construct vec-permutation matrix<a class="anchor" aria-label="anchor" href="#construct-vec-permutation-matrix"></a>
</h5>
<p>Next, we construct the vec-permutation matrix. Essentially, the
vec-permutation matrix helps us relate demographic and dispersal
parameters so that populations in patches are projected considering
births, immigration, deaths, and emigration (BIDE) or recruitment,
immigration, survival, and emigration (RISE). The
<code><a href="../reference/vec.perm.html">metapopbio::vec.perm</a></code> function helps us to easily construct
a vec-permutation matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">P</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/vec.perm.html">vec.perm</a></span><span class="op">(</span>n_stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>           n_patches <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>           group_by <span class="op">=</span> <span class="va">group_by</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="demographic-parameters-for-each-patch">3. Demographic parameters for each patch<a class="anchor" aria-label="anchor" href="#demographic-parameters-for-each-patch"></a>
</h5>
<p>We now specify transition probabilities from one stage to the next
(survival <em>s</em> and recruitment <em>r</em>). Numbers in object
names indicate patch then stage. Only adults are assumed to
reproduce.</p>
<p>Northern first.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Northern</span></span>
<span><span class="va">f11</span> <span class="op">&lt;-</span> <span class="fl">0.00</span> </span>
<span><span class="va">f12</span> <span class="op">&lt;-</span> <span class="fl">0.2556</span></span>
<span><span class="va">s11</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span>
<span><span class="va">s12</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></code></pre></div>
<p>Now Southern.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Southern</span></span>
<span><span class="va">f21</span> <span class="op">&lt;-</span> <span class="fl">0.00</span></span>
<span><span class="va">f22</span> <span class="op">&lt;-</span> <span class="fl">0.1908</span>  </span>
<span><span class="va">s21</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span>
<span><span class="va">s22</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="a--structure-demographic-parameters">4a. Structure demographic parameters<a class="anchor" aria-label="anchor" href="#a--structure-demographic-parameters"></a>
</h5>
<p>Now we will construct demographic (Leslise-style) matrices for each
of the patches. This is just placing the demographic parameters from
above into an ordered matrices for analysis and projecting.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Northern</span></span>
<span><span class="op">(</span><span class="va">B1x</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f11</span>, <span class="va">f12</span>, <span class="va">s11</span>, <span class="va">s12</span><span class="op">)</span>,</span>
<span>         nrow <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         ncol <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]   [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.2556</span></span>
<span><span class="co">#&gt; [2,] 0.72 0.7700</span></span>
<span><span class="co"># Southern</span></span>
<span><span class="op">(</span><span class="va">B2x</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f21</span>, <span class="va">f22</span>, <span class="va">s21</span>, <span class="va">s22</span><span class="op">)</span>,</span>
<span>         nrow <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         ncol <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]   [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.1908</span></span>
<span><span class="co">#&gt; [2,] 0.72 0.7700</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="b--construct-block-diagonal-matrix">4b. Construct block diagonal matrix<a class="anchor" aria-label="anchor" href="#b--construct-block-diagonal-matrix"></a>
</h5>
<p>Along with the vec-permutation matrix, spatial matrix population
models use a matrix of matrices for analysis and projection of
population demographics and movement. We accomplish this using the
<code><a href="../reference/blk.diag.html">metapopbio::blk.diag</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">BB</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">B1x</span>, <span class="va">B2x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]   [,2] [,3]   [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.2556 0.00 0.0000</span></span>
<span><span class="co">#&gt; [2,] 0.72 0.7700 0.00 0.0000</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.0000 0.00 0.1908</span></span>
<span><span class="co">#&gt; [4,] 0.00 0.0000 0.72 0.7700</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="structure-movement-parameters">5. Structure movement parameters<a class="anchor" aria-label="anchor" href="#structure-movement-parameters"></a>
</h5>
<p>Similar to the above, we will construct movement or dispersal
matrices for each of the stages. This is just placing movement
parameters into an ordered matrices for analysis and projecting. We
assume that only juveniles disperse, therefore an identity matrix is
specified for adult movement.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Juveniles</span></span>
<span><span class="va">dx1</span> <span class="op">&lt;-</span> <span class="fl">0.27</span> </span>
<span><span class="va">dx2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">dx1</span></span>
<span><span class="op">(</span><span class="va">Mx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dx2</span>, <span class="va">dx1</span>, <span class="va">dx1</span>, <span class="va">dx2</span><span class="op">)</span>,</span>
<span>              nrow <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>              ncol <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>              byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.73 0.27</span></span>
<span><span class="co">#&gt; [2,] 0.27 0.73</span></span>
<span><span class="co"># Adults</span></span>
<span><span class="op">(</span><span class="va">Mx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">n_patches</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    0</span></span>
<span><span class="co">#&gt; [2,]    0    1</span></span>
<span><span class="co"># Block diagonal matrix</span></span>
<span><span class="op">(</span><span class="va">MM</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Mx1</span>, <span class="va">Mx2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.73 0.27    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.27 0.73    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.00    1    0</span></span>
<span><span class="co">#&gt; [4,] 0.00 0.00    0    1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-projection-matrix">6. Construct projection matrix<a class="anchor" aria-label="anchor" href="#construct-projection-matrix"></a>
</h5>
<p>Now we can use the vec-permutation matrix and block diagonal matrices
to construct a population projection matrix. This is accomplished
through matrix multiplication. The order of matrices is very important
(see Hunter and Caswell 2005 or function documentation for more detail),
but the <code><a href="../reference/spmm.project.matrix.html">metapopbio::spmm.project.matrix</a></code> function makes it
much more convenient and reduces the probability of calculation errors.
All that’s needed is to specify the grouping (structure) for the
projection (stages within patches here) and the order type between
demographic and movement / dispersal processes (here, dispersal then
demographics), then supply the matrices we have constructed (P, BB, and
MM).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span>
<span><span class="va">lh_order</span> <span class="op">&lt;-</span> <span class="st">"move"</span></span>
<span><span class="op">(</span><span class="va">A</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.matrix.html">spmm.project.matrix</a></span><span class="op">(</span></span>
<span>    P <span class="op">=</span> <span class="va">P</span>,</span>
<span>    BB <span class="op">=</span> <span class="va">BB</span>,</span>
<span>    MM <span class="op">=</span> <span class="va">MM</span>,</span>
<span>    group_by <span class="op">=</span> <span class="va">group_by</span>,</span>
<span>    lh_order <span class="op">=</span> <span class="va">lh_order</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1]   [,2]   [,3]   [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.0000 0.2556 0.0000 0.0000</span></span>
<span><span class="co">#&gt; [2,] 0.5256 0.7700 0.1944 0.0000</span></span>
<span><span class="co">#&gt; [3,] 0.0000 0.0000 0.0000 0.1908</span></span>
<span><span class="co">#&gt; [4,] 0.1944 0.0000 0.5256 0.7700</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="project">7. Project<a class="anchor" aria-label="anchor" href="#project"></a>
</h5>
<p>Now we can project populations into future time steps. First, we have
to indicate the starting, initial, or current sizes of each stage by
patch, or vice versa if grouping by stages. An added step is to comment
on the vector which ensures projection calculations are correct. The
numbers for <strong>n</strong> below were retrieved from Table 1 of
Wootton and Bell (1992).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">60</span>, <span class="fl">19</span>,  <span class="co"># Northern patch adults then juveniles</span></span>
<span>  <span class="fl">29</span>, <span class="fl">20</span>   <span class="co"># Southern patch adults then juveniles</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/comment.html" class="external-link">comment</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"patches"</span>  <span class="co"># vector attr for group_by </span></span></code></pre></div>
<p>Now we indicate the number of time steps we would like to
project.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_timesteps</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></code></pre></div>
<p>And, finally we can project stages within patches using the
<code><a href="../reference/spmm.project.html">metapopbio::spmm.project</a></code> function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span></span>
<span>  <span class="va">projs</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.html">spmm.project</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="va">n</span>,</span>
<span>      A <span class="op">=</span> <span class="va">A</span>,</span>
<span>      n_timesteps <span class="op">=</span> <span class="va">n_timesteps</span>,</span>
<span>      n_stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>      n_patches <span class="op">=</span> <span class="va">n_patches</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Deterministic spatial matrix model projections for patches structured population vector and movement then demography A projection matrix. The arg mod_move is currently ignored; please modify manually."</span></span>
<span><span class="co">#&gt;       1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25</span></span>
<span><span class="co">#&gt; [1,] 60  4 13 10  9  9  8  7  7  6  6  5  5  4  4  3  3  2  2  2  1  1  1  1  0</span></span>
<span><span class="co">#&gt; [2,] 19 51 41 39 36 33 31 29 26 24 22 20 18 16 14 13 11 10  8  7  6  5  4  3  2</span></span>
<span><span class="co">#&gt; [3,] 29  3  8  6  6  5  5  4  4  4  3  3  2  2  2  2  1  1  1  1  1  0  0  0  0</span></span>
<span><span class="co">#&gt; [4,] 20 42 34 32 29 27 25 23 21 19 17 15 14 12 11 10  9  8  7  6  5  4  3  2  1</span></span>
<span><span class="co">#&gt;      26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50</span></span>
<span><span class="co">#&gt; [1,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt; [2,]  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt; [3,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt; [4,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt;      51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75</span></span>
<span><span class="co">#&gt; [1,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt; [2,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt; [3,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt; [4,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt;      76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99</span></span>
<span><span class="co">#&gt; [1,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt; [2,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt; [3,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt; [4,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">#&gt;      100</span></span>
<span><span class="co">#&gt; [1,]   0</span></span>
<span><span class="co">#&gt; [2,]   0</span></span>
<span><span class="co">#&gt; [3,]   0</span></span>
<span><span class="co">#&gt; [4,]   0</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="plotting">8. Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h5>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stage_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Juv."</span>, <span class="st">"Adults"</span><span class="op">)</span></span>
<span><span class="va">patch_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"North"</span>, <span class="st">"South"</span><span class="op">)</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.plot.html">spmm.plot</a></span><span class="op">(</span></span>
<span>  projections <span class="op">=</span> <span class="va">projs</span>,</span>
<span>  ylabs <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>  xlabs <span class="op">=</span> <span class="st">"Years"</span>,</span>
<span>  stage_names <span class="op">=</span> <span class="va">stage_names</span>,</span>
<span>  patch_names <span class="op">=</span> <span class="va">patch_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-13-1.png" width="700"><img src="getting-started_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="sensitivity-and-elasticity-analyses">9. Sensitivity and elasticity analyses<a class="anchor" aria-label="anchor" href="#sensitivity-and-elasticity-analyses"></a>
</h5>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.matrix.sens.html">spmm.project.matrix.sens</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]      [,2]       [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.10622465 0.3920347 0.06232833 0.3081536</span></span>
<span><span class="co">#&gt; [2,] 0.15665059 0.5781376 0.09191624 0.4544372</span></span>
<span><span class="co">#&gt; [3,] 0.08349644 0.3081536 0.04899234 0.2422199</span></span>
<span><span class="co">#&gt; [4,] 0.09191624 0.3392278 0.05393274 0.2666454</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.eig.lambda.html">spmm.eig.lambda</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt; $eig</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1]  0.94332217  0.85335264 -0.17332217 -0.08335264</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;           [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.2068106 -0.1472176 -0.6920115  0.5741311</span></span>
<span><span class="co">#&gt; [2,] 0.7632592 -0.4915044  0.4692525 -0.1872275</span></span>
<span><span class="co">#&gt; [3,] 0.1213481  0.1872911 -0.4060444 -0.7304128</span></span>
<span><span class="co">#&gt; [4,] 0.5999495  0.8376589  0.3688496  0.3190872</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda</span></span>
<span><span class="co">#&gt; [1] 0.9433222</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $v</span></span>
<span><span class="co">#&gt; [1] 0.2068106 0.7632592 0.1213481 0.5999495</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $eig_t</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1]  0.94332217  0.85335264 -0.17332217 -0.08335264</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] -0.4692525 -0.1872275 -0.7632592 -0.4915044</span></span>
<span><span class="co">#&gt; [2,] -0.6920115 -0.5741311  0.2068106  0.1472176</span></span>
<span><span class="co">#&gt; [3,] -0.3688496  0.3190872 -0.5999495  0.8376589</span></span>
<span><span class="co">#&gt; [4,] -0.4060444  0.7304128  0.1213481 -0.1872911</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $w</span></span>
<span><span class="co">#&gt; [1] -0.4692525 -0.6920115 -0.3688496 -0.4060444</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.demo.sens.html">spmm.demo.sens</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.10008803 0.15665059 0.08963306 0.09191624</span></span>
<span><span class="co">#&gt; [2,] 0.36938677 0.57813760 0.33080146 0.33922779</span></span>
<span><span class="co">#&gt; [3,] 0.05872761 0.09191624 0.05259306 0.05393274</span></span>
<span><span class="co">#&gt; [4,] 0.29035147 0.45443723 0.26002200 0.26664541</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.demo.elas.html">spmm.demo.elas</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]       [,2]      [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.0000000 0.04244561 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; [2,] 0.2819381 0.47191295 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; [3,] 0.0000000 0.00000000 0.0000000 0.01090864</span></span>
<span><span class="co">#&gt; [4,] 0.0000000 0.00000000 0.1984644 0.21765307</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.move.sens.html">spmm.move.sens</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.2822650 0.2218706 0.4162591 0.2442440</span></span>
<span><span class="co">#&gt; [2,] 0.2218706 0.1743983 0.3271948 0.1919847</span></span>
<span><span class="co">#&gt; [3,] 0.3290177 0.2586199 0.4852058 0.2846992</span></span>
<span><span class="co">#&gt; [4,] 0.2491705 0.1958571 0.3674543 0.2156073</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.move.elas.html">spmm.move.elas</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]       [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.21843378 0.06350434 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,] 0.06350434 0.13496003 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [3,] 0.00000000 0.00000000 0.5143586 0.0000000</span></span>
<span><span class="co">#&gt; [4,] 0.00000000 0.00000000 0.0000000 0.2285617</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="the-black-headed-gull">The black-headed gull<a class="anchor" aria-label="anchor" href="#the-black-headed-gull"></a>
</h3>
<p>Fewer comments are provided for this example but it should be noted
that the grouping (structure of n) is by stages in this example. The
life-cycle order remains the same, i.e., movement then demographics
(only juveniles assumed to disperse).</p>
<div class="section level5">
<h5 id="patches-stages-and-grouping-1">1. Patches, stages, and grouping<a class="anchor" aria-label="anchor" href="#patches-stages-and-grouping-1"></a>
</h5>
<p>First, we define the number of patches and stages (age, class, or
size). In this example there are two “patches” and five life-stages. We
also group or will project patches within stages.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_patches</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">n_stages</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"stages"</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-vec-permutation-matrix-1">2. Construct vec-permutation matrix<a class="anchor" aria-label="anchor" href="#construct-vec-permutation-matrix-1"></a>
</h5>
<p>Next, we construct the vec-permutation matrix.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">P</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/vec.perm.html">vec.perm</a></span><span class="op">(</span>n_stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>           n_patches <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>           group_by <span class="op">=</span> <span class="va">group_by</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,]    1    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [2,]    0    0    0    0    0    1    0    0    0     0</span></span>
<span><span class="co">#&gt;  [3,]    0    1    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [4,]    0    0    0    0    0    0    1    0    0     0</span></span>
<span><span class="co">#&gt;  [5,]    0    0    1    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [6,]    0    0    0    0    0    0    0    1    0     0</span></span>
<span><span class="co">#&gt;  [7,]    0    0    0    1    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [8,]    0    0    0    0    0    0    0    0    1     0</span></span>
<span><span class="co">#&gt;  [9,]    0    0    0    0    1    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [10,]    0    0    0    0    0    0    0    0    0     1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="define-and-structure-demographic-parameters">3. Define and structure Demographic parameters<a class="anchor" aria-label="anchor" href="#define-and-structure-demographic-parameters"></a>
</h5>
<p>We now specify transition probabilities from one stage to the next.
Only adults are assumed to reproduce and differential among adult
stages. We will specify demographic parameters and structure the
(Leslie-style) matrices for each patch simultaneously.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B1x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">0.096</span>, <span class="fl">0.160</span>, <span class="fl">0.224</span>, <span class="fl">0.320</span>,</span>
<span>                <span class="fl">0.800</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.820</span><span class="op">)</span>,</span>
<span>              nrow <span class="op">=</span> <span class="va">n_stages</span>, ncol <span class="op">=</span> <span class="va">n_stages</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">B2x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">0.100</span>, <span class="fl">0.160</span>, <span class="fl">0.200</span>, <span class="fl">0.200</span>,</span>
<span>                <span class="fl">0.800</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.820</span><span class="op">)</span>,</span>
<span>              nrow <span class="op">=</span> <span class="va">n_stages</span>, ncol <span class="op">=</span> <span class="va">n_stages</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-block-diagonal-matrix">4. Construct block diagonal matrix<a class="anchor" aria-label="anchor" href="#construct-block-diagonal-matrix"></a>
</h5>
<p>Along with the vec-permutation matrix, spatial matrix population
models use a matrix of matrices for analysis and projection of
population demographics and movement. We accomplish this using the
<code><a href="../reference/blk.diag.html">metapopbio::blk.diag</a></code> function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">BB</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">B1x</span>, <span class="va">B2x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1]  [,2] [,3]  [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,]  0.0 0.096 0.16 0.224 0.32  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [2,]  0.8 0.000 0.00 0.000 0.00  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [3,]  0.0 0.820 0.00 0.000 0.00  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [4,]  0.0 0.000 0.82 0.000 0.00  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [5,]  0.0 0.000 0.00 0.820 0.82  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [6,]  0.0 0.000 0.00 0.000 0.00  0.0 0.10 0.16 0.20  0.20</span></span>
<span><span class="co">#&gt;  [7,]  0.0 0.000 0.00 0.000 0.00  0.8 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [8,]  0.0 0.000 0.00 0.000 0.00  0.0 0.82 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [9,]  0.0 0.000 0.00 0.000 0.00  0.0 0.00 0.82 0.00  0.00</span></span>
<span><span class="co">#&gt; [10,]  0.0 0.000 0.00 0.000 0.00  0.0 0.00 0.00 0.82  0.82</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="structure-movement-parameters-1">5. Structure movement parameters<a class="anchor" aria-label="anchor" href="#structure-movement-parameters-1"></a>
</h5>
<p>Similar to the above, we will construct movement or dispersal
matrices for each of the stages. This is just placing movement
parameters into an ordered matrices for analysis and projecting. We
assume that only juveniles disperse, therefore an identity matrix is
specified for adult movement.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Juveniles</span></span>
<span><span class="va">Mx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.375</span>, <span class="fl">0.25</span>, <span class="fl">0.625</span><span class="op">)</span>,</span>
<span>              nrow <span class="op">=</span> <span class="va">n_patches</span>, ncol <span class="op">=</span> <span class="va">n_patches</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Adults</span></span>
<span><span class="va">Mx5</span> <span class="op">&lt;-</span> <span class="va">Mx4</span> <span class="op">&lt;-</span> <span class="va">Mx3</span> <span class="op">&lt;-</span> <span class="va">Mx2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">n_patches</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Block diagonal matrix</span></span>
<span><span class="op">(</span><span class="va">MM</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Mx1</span>, <span class="va">Mx2</span>, <span class="va">Mx3</span>, <span class="va">Mx4</span>, <span class="va">Mx5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1]  [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.75 0.375    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [2,] 0.25 0.625    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [3,] 0.00 0.000    1    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [4,] 0.00 0.000    0    1    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [5,] 0.00 0.000    0    0    1    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [6,] 0.00 0.000    0    0    0    1    0    0    0     0</span></span>
<span><span class="co">#&gt;  [7,] 0.00 0.000    0    0    0    0    1    0    0     0</span></span>
<span><span class="co">#&gt;  [8,] 0.00 0.000    0    0    0    0    0    1    0     0</span></span>
<span><span class="co">#&gt;  [9,] 0.00 0.000    0    0    0    0    0    0    1     0</span></span>
<span><span class="co">#&gt; [10,] 0.00 0.000    0    0    0    0    0    0    0     1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-projection-matrix-1">6. Construct projection matrix<a class="anchor" aria-label="anchor" href="#construct-projection-matrix-1"></a>
</h5>
<p>Now we can use the vec-permutation matrix and block diagonal matrices
to construct a population projection matrix. This is accomplished
through matrix multiplication. The order of matrices is very important
(see Hunter and Caswell 2005 or function documentation for more detail),
but the <code><a href="../reference/spmm.project.matrix.html">metapopbio::spmm.project.matrix</a></code> function makes it
much more convenient and reduces the probability of calculation errors.
All that’s needed is to specify the grouping (structure) for the
projection (stages within patches here) and the order type between
demographic and movement / dispersal processes (here, dispersal then
demographics), then supply the matrices we have constructed (P, BB, and
MM).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"stages"</span></span>
<span><span class="va">lh_order</span> <span class="op">&lt;-</span> <span class="st">"move"</span></span>
<span><span class="op">(</span><span class="va">A</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.matrix.html">spmm.project.matrix</a></span><span class="op">(</span></span>
<span>    P <span class="op">=</span> <span class="va">P</span>,</span>
<span>    BB <span class="op">=</span> <span class="va">BB</span>,</span>
<span>    MM <span class="op">=</span> <span class="va">MM</span>,</span>
<span>    group_by <span class="op">=</span> <span class="va">group_by</span>,</span>
<span>    lh_order <span class="op">=</span> <span class="va">lh_order</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2]  [,3] [,4] [,5] [,6]  [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,]  0.0  0.0 0.096 0.00 0.16 0.00 0.224 0.00 0.32  0.00</span></span>
<span><span class="co">#&gt;  [2,]  0.0  0.0 0.000 0.10 0.00 0.16 0.000 0.20 0.00  0.20</span></span>
<span><span class="co">#&gt;  [3,]  0.6  0.3 0.000 0.00 0.00 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [4,]  0.2  0.5 0.000 0.00 0.00 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [5,]  0.0  0.0 0.820 0.00 0.00 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [6,]  0.0  0.0 0.000 0.82 0.00 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [7,]  0.0  0.0 0.000 0.00 0.82 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [8,]  0.0  0.0 0.000 0.00 0.00 0.82 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [9,]  0.0  0.0 0.000 0.00 0.00 0.00 0.820 0.00 0.82  0.00</span></span>
<span><span class="co">#&gt; [10,]  0.0  0.0 0.000 0.00 0.00 0.00 0.000 0.82 0.00  0.82</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="project-1">7. Project<a class="anchor" aria-label="anchor" href="#project-1"></a>
</h5>
<p>Now we can project populations into future time steps. First, we have
to indicate the starting, initial, or current sizes of each patch by
stage. I have made these up as they were not avilable in Hunter and
Morris (2005) nor Lebreton (1996). An added step is to comment on the
vector which ensures projection calculations are correct.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">100</span>, <span class="fl">90</span>,  <span class="co"># stage 1</span></span>
<span>  <span class="fl">78</span>, <span class="fl">77</span>,  <span class="co"># stage 2</span></span>
<span>  <span class="fl">50</span>, <span class="fl">48</span>,  <span class="co"># stage 3</span></span>
<span>  <span class="fl">40</span>, <span class="fl">36</span>,  <span class="co"># stage 4</span></span>
<span>  <span class="fl">29</span>, <span class="fl">28</span>  <span class="co"># stage 5</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/comment.html" class="external-link">comment</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"stages"</span>  <span class="co"># vector attr for group_by </span></span></code></pre></div>
<p>Now we indicate the number of time steps we would like to
project.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_timesteps</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></code></pre></div>
<p>And, finally we can project stages within patches using the
<code><a href="../reference/spmm.project.html">metapopbio::spmm.project</a></code> function.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span></span>
<span>  <span class="va">projs</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.html">spmm.project</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="va">n</span>,</span>
<span>      A <span class="op">=</span> <span class="va">A</span>,</span>
<span>      n_timesteps <span class="op">=</span> <span class="va">n_timesteps</span>,</span>
<span>      n_stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>      n_patches <span class="op">=</span> <span class="va">n_patches</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Deterministic spatial matrix model projections for stages structured population vector and movement then demography A projection matrix. The arg mod_move is currently ignored; please modify manually."</span></span>
<span><span class="co">#&gt;        1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24</span></span>
<span><span class="co">#&gt; [1,] 100 33 45 50 53 55 54 54 53 53 53 53 53 52 52 51 51 50 50 49 49 48 47 47</span></span>
<span><span class="co">#&gt; [2,]  90 28 34 35 34 32 31 30 29 28 27 26 25 24 23 23 22 22 21 21 20 19 19 19</span></span>
<span><span class="co">#&gt; [3,]  78 87 28 37 40 42 42 41 41 40 40 39 39 39 38 38 37 37 36 36 35 35 34 33</span></span>
<span><span class="co">#&gt; [4,]  77 65 20 26 27 27 27 26 25 25 24 24 23 23 22 21 21 21 21 20 20 19 19 18</span></span>
<span><span class="co">#&gt; [5,]  50 63 71 22 30 32 34 34 33 33 32 32 31 31 31 31 31 30 30 29 29 28 28 27</span></span>
<span><span class="co">#&gt; [6,]  48 63 53 16 21 22 22 22 21 20 20 19 19 18 18 18 17 17 17 17 16 16 15 15</span></span>
<span><span class="co">#&gt;      25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49</span></span>
<span><span class="co">#&gt; [1,] 46 45 45 44 44 43 43 42 41 41 40 39 38 37 37 37 36 36 35 35 34 33 33 32 31</span></span>
<span><span class="co">#&gt; [2,] 18 18 17 17 16 16 16 15 15 15 14 14 14 13 13 13 12 12 12 12 12 11 11 11 11</span></span>
<span><span class="co">#&gt; [3,] 33 33 32 32 31 31 30 30 29 29 29 28 27 27 26 26 26 25 25 24 24 24 23 23 22</span></span>
<span><span class="co">#&gt; [4,] 18 18 18 17 17 16 16 16 15 15 15 15 14 14 13 13 13 13 13 13 13 12 12 12 11</span></span>
<span><span class="co">#&gt; [5,] 27 27 27 26 26 25 25 24 24 23 23 23 22 22 22 21 21 21 20 20 19 19 19 18 18</span></span>
<span><span class="co">#&gt; [6,] 14 14 14 14 13 13 13 13 13 12 12 12 12 11 11 10 10 10 10 10 10 10  9  9  9</span></span>
<span><span class="co">#&gt;      50</span></span>
<span><span class="co">#&gt; [1,] 31</span></span>
<span><span class="co">#&gt; [2,] 10</span></span>
<span><span class="co">#&gt; [3,] 21</span></span>
<span><span class="co">#&gt; [4,] 11</span></span>
<span><span class="co">#&gt; [5,] 18</span></span>
<span><span class="co">#&gt; [6,]  9</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="plotting-1">8. Plotting<a class="anchor" aria-label="anchor" href="#plotting-1"></a>
</h5>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stage_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">patch_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.plot.html">spmm.plot</a></span><span class="op">(</span></span>
<span>  projections <span class="op">=</span> <span class="va">projs</span>,</span>
<span>  ylabs <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>  xlabs <span class="op">=</span> <span class="st">"Years"</span>,</span>
<span>  stage_names <span class="op">=</span> <span class="va">stage_names</span>,</span>
<span>  patch_names <span class="op">=</span> <span class="va">patch_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-24-1.png" width="700"><img src="getting-started_files/figure-html/unnamed-chunk-24-2.png" width="700"><img src="getting-started_files/figure-html/unnamed-chunk-24-3.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="sensitivity-and-elasticity-analyses-1">9. Sensitivity and elasticity analyses<a class="anchor" aria-label="anchor" href="#sensitivity-and-elasticity-analyses-1"></a>
</h5>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.matrix.sens.html">spmm.project.matrix.sens</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]          [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.09755745+0i 0.03894678+0i 0.07042373+0i 0.03909882+0i 0.05791623+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.08124494+0i 0.03243452+0i 0.05864823+0i 0.03256113+0i 0.04823210+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.13514559+0i 0.05395267+0i 0.09755745+0i 0.05416329+0i 0.08023091+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.08092901+0i 0.03230839+0i 0.05842017+0i 0.03243452+0i 0.04804455+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.15291005+0i 0.06104458+0i 0.11038107+0i 0.06128289+0i 0.09077701+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.08849839+0i 0.03533023+0i 0.06388427+0i 0.03546815+0i 0.05253820+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.16689665+0i 0.06662830+0i 0.12047757+0i 0.06688840+0i 0.09908034+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.09175768+0i 0.03663140+0i 0.06623705+0i 0.03677440+0i 0.05447313+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.17628954+0i 0.07037812+0i 0.12725801+0i 0.07065286+0i 0.10465655+0i</span></span>
<span><span class="co">#&gt; [10,] 0.09175768+0i 0.03663140+0i 0.06623705+0i 0.03677440+0i 0.05447313+0i</span></span>
<span><span class="co">#&gt;                [,6]          [,7]          [,8]         [,9]        [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.03215474+0i 0.04763011+0i 0.02644394+0i 0.2205523+0i 0.1224493+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.02677817+0i 0.03966592+0i 0.02202227+0i 0.1836739+0i 0.1019746+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.04454371+0i 0.06598163+0i 0.03663259+0i 0.3055294+0i 0.1696280+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.02667404+0i 0.03951167+0i 0.02193664+0i 0.1829597+0i 0.1015781+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.05039884+0i 0.07465471+0i 0.04144783+0i 0.3456903+0i 0.1919251+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.02916889+0i 0.04320724+0i 0.02398839+0i 0.2000721+0i 0.1110788+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.05500879+0i 0.08148333+0i 0.04523904+0i 0.3773104+0i 0.2094804+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.03024314+0i 0.04479851+0i 0.02487186+0i 0.2074405+0i 0.1151697+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.05810467+0i 0.08606919+0i 0.04778508+0i 0.3985453+0i 0.2212699+0i</span></span>
<span><span class="co">#&gt; [10,] 0.03024314+0i 0.04479851+0i 0.02487186+0i 0.2074405+0i 0.1151697+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.eig.lambda.html">spmm.eig.lambda</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt; $eig</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt;  [1]  9.970859e-01+0.0000000i  8.919222e-01+0.0000000i  2.182849e-01+0.4025870i</span></span>
<span><span class="co">#&gt;  [4]  2.182849e-01-0.4025870i -3.024940e-01+0.2461757i -3.024940e-01-0.2461757i</span></span>
<span><span class="co">#&gt;  [7]  6.112978e-02+0.2358721i  6.112978e-02-0.2358721i -2.028494e-01+0.0000000i</span></span>
<span><span class="co">#&gt; [10]  1.791285e-15+0.0000000i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;                 [,1]           [,2]                     [,3]</span></span>
<span><span class="co">#&gt;  [1,] -0.32790653+0i -0.18212972+0i  0.116056424-0.07487059i</span></span>
<span><span class="co">#&gt;  [2,] -0.13090649+0i  0.22690373+0i  0.006076633+0.01670070i</span></span>
<span><span class="co">#&gt;  [3,] -0.23670566+0i -0.04619989+0i -0.002241819-0.17870968i</span></span>
<span><span class="co">#&gt;  [4,] -0.13141752+0i  0.08635946+0i  0.014606045-0.05728283i</span></span>
<span><span class="co">#&gt;  [5,] -0.19466592+0i -0.04247446+0i -0.283215006-0.14899452i</span></span>
<span><span class="co">#&gt;  [6,] -0.10807732+0i  0.07939566+0i -0.077701404-0.07188011i</span></span>
<span><span class="co">#&gt;  [7,] -0.16009259+0i -0.03904943+0i -0.476243342+0.31863815i</span></span>
<span><span class="co">#&gt;  [8,] -0.08888242+0i  0.07299341+0i -0.179460166+0.06096001i</span></span>
<span><span class="co">#&gt;  [9,] -0.74131229+0i -0.44521053+0i  0.649010676+0.00000000i</span></span>
<span><span class="co">#&gt; [10,] -0.41157200+0i  0.83221273+0i  0.207333032+0.05564490i</span></span>
<span><span class="co">#&gt;                           [,4]                      [,5]</span></span>
<span><span class="co">#&gt;  [1,]  0.116056424+0.07487059i  0.05022988+0.0927743125i</span></span>
<span><span class="co">#&gt;  [2,]  0.006076633-0.01670070i -0.00445866-0.0004872395i</span></span>
<span><span class="co">#&gt;  [3,] -0.002241819+0.17870968i  0.03257850-0.1570225501i</span></span>
<span><span class="co">#&gt;  [4,]  0.014606045+0.05728283i  0.01409087-0.0490667965i</span></span>
<span><span class="co">#&gt;  [5,] -0.283215006+0.14899452i -0.26151751+0.2128281605i</span></span>
<span><span class="co">#&gt;  [6,] -0.077701404+0.07188011i -0.08809695+0.0613150917i</span></span>
<span><span class="co">#&gt;  [7,] -0.476243342-0.31863815i  0.70892098+0.0000000000i</span></span>
<span><span class="co">#&gt;  [8,] -0.179460166-0.06096001i  0.22503737+0.0169271029i</span></span>
<span><span class="co">#&gt;  [9,]  0.649010676+0.00000000i -0.49411266-0.1083645061i</span></span>
<span><span class="co">#&gt; [10,]  0.207333032-0.05564490i -0.15426192-0.0461969101i</span></span>
<span><span class="co">#&gt;                            [,6]                      [,7]</span></span>
<span><span class="co">#&gt;  [1,]  0.05022988-0.0927743125i  0.014698188+0.010441279i</span></span>
<span><span class="co">#&gt;  [2,] -0.00445866+0.0004872395i -0.031370628-0.018391363i</span></span>
<span><span class="co">#&gt;  [3,]  0.03257850+0.1570225501i  0.002359263+0.003122440i</span></span>
<span><span class="co">#&gt;  [4,]  0.01409087+0.0490667965i -0.041358939+0.043317596i</span></span>
<span><span class="co">#&gt;  [5,] -0.26151751-0.2128281605i  0.012163687-0.005049481i</span></span>
<span><span class="co">#&gt;  [6,] -0.08809695-0.0613150917i  0.106195671+0.171304886i</span></span>
<span><span class="co">#&gt;  [7,]  0.70892098+0.0000000000i -0.006180033-0.043888220i</span></span>
<span><span class="co">#&gt;  [8,]  0.22503737-0.0169271029i  0.647709984-0.201321292i</span></span>
<span><span class="co">#&gt;  [9,] -0.49411266+0.1083645061i -0.007352067+0.045138406i</span></span>
<span><span class="co">#&gt; [10,] -0.15426192+0.0461969101i -0.699885399+0.000000000i</span></span>
<span><span class="co">#&gt;                            [,8]            [,9]            [,10]</span></span>
<span><span class="co">#&gt;  [1,]  0.014698188-0.010441279i  0.010988584+0i -5.224894e-16+0i</span></span>
<span><span class="co">#&gt;  [2,] -0.031370628+0.018391363i -0.023369498+0i -3.630818e-17+0i</span></span>
<span><span class="co">#&gt;  [3,]  0.002359263-0.003122440i  0.002059156+0i  1.699276e-16+0i</span></span>
<span><span class="co">#&gt;  [4,] -0.041358939-0.043317596i  0.046768853+0i  1.250305e-16+0i</span></span>
<span><span class="co">#&gt;  [5,]  0.012163687+0.005049481i -0.008323952+0i -2.213028e-17+0i</span></span>
<span><span class="co">#&gt;  [6,]  0.106195671-0.171304886i -0.189058814+0i -1.216778e-15+0i</span></span>
<span><span class="co">#&gt;  [7,] -0.006180033+0.043888220i  0.033648815+0i  1.660406e-15+0i</span></span>
<span><span class="co">#&gt;  [8,]  0.647709984+0.201321292i  0.764252980+0i -7.071068e-01+0i</span></span>
<span><span class="co">#&gt;  [9,] -0.007352067-0.045138406i -0.026975652+0i -1.566664e-15+0i</span></span>
<span><span class="co">#&gt; [10,] -0.699885399+0.000000000i -0.612687917+0i  7.071068e-01+0i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda</span></span>
<span><span class="co">#&gt; [1] 0.9970859</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $v</span></span>
<span><span class="co">#&gt;  [1] -0.32790653+0i -0.13090649+0i -0.23670566+0i -0.13141752+0i -0.19466592+0i</span></span>
<span><span class="co">#&gt;  [6] -0.10807732+0i -0.16009259+0i -0.08888242+0i -0.74131229+0i -0.41157200+0i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $eig_t</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt;  [1]  9.970859e-01+0.0000000i  8.919222e-01+0.0000000i  2.182849e-01+0.4025870i</span></span>
<span><span class="co">#&gt;  [4]  2.182849e-01-0.4025870i -3.024940e-01+0.2461757i -3.024940e-01-0.2461757i</span></span>
<span><span class="co">#&gt;  [7]  6.112978e-02+0.2358721i  6.112978e-02-0.2358721i -2.028494e-01+0.0000000i</span></span>
<span><span class="co">#&gt; [10]  1.718711e-15+0.0000000i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;               [,1]           [,2]                    [,3]</span></span>
<span><span class="co">#&gt;  [1,] 0.2536597+0i  0.05633004+0i  0.62139103+0.00000000i</span></span>
<span><span class="co">#&gt;  [2,] 0.2112455+0i -0.15794294+0i  0.29776448+0.07991527i</span></span>
<span><span class="co">#&gt;  [3,] 0.3513929+0i  0.22206487+0i  0.25523002+0.40674126i</span></span>
<span><span class="co">#&gt;  [4,] 0.2104240+0i -0.41498457+0i -0.08748875+0.03059607i</span></span>
<span><span class="co">#&gt;  [5,] 0.3975824+0i  0.23494746+0i -0.20449932+0.23358264i</span></span>
<span><span class="co">#&gt;  [6,] 0.2301052+0i -0.43212154+0i -0.07462378-0.04455451i</span></span>
<span><span class="co">#&gt;  [7,] 0.4339490+0i  0.24456348+0i -0.29036465-0.03822100i</span></span>
<span><span class="co">#&gt;  [8,] 0.2385797+0i -0.43920480+0i -0.05609084-0.06409096i</span></span>
<span><span class="co">#&gt;  [9,] 0.4583715+0i  0.25062643+0i -0.22827625-0.15273184i</span></span>
<span><span class="co">#&gt; [10,] 0.2385797+0i -0.43920480+0i -0.05609084-0.06409096i</span></span>
<span><span class="co">#&gt;                          [,4]                      [,5]</span></span>
<span><span class="co">#&gt;  [1,]  0.62139103+0.00000000i -0.731336362+0.000000000i</span></span>
<span><span class="co">#&gt;  [2,]  0.29776448-0.07991527i -0.348229238-0.026193482i</span></span>
<span><span class="co">#&gt;  [3,]  0.25523002-0.40674126i  0.367730607-0.310242367i</span></span>
<span><span class="co">#&gt;  [4,] -0.08748875-0.03059607i  0.002932555+0.030541037i</span></span>
<span><span class="co">#&gt;  [5,] -0.20449932-0.23358264i  0.043105002+0.224844860i</span></span>
<span><span class="co">#&gt;  [6,] -0.07462378+0.04455451i  0.032216321-0.007191719i</span></span>
<span><span class="co">#&gt;  [7,] -0.29036465+0.03822100i  0.059296927-0.070003443i</span></span>
<span><span class="co">#&gt;  [8,] -0.05609084+0.06409096i  0.058221780+0.017435711i</span></span>
<span><span class="co">#&gt;  [9,] -0.22827625+0.15273184i  0.198921369+0.043625711i</span></span>
<span><span class="co">#&gt; [10,] -0.05609084+0.06409096i  0.058221780+0.017435711i</span></span>
<span><span class="co">#&gt;                            [,6]                     [,7]</span></span>
<span><span class="co">#&gt;  [1,] -0.731336362+0.000000000i  0.005488647-0.03369784i</span></span>
<span><span class="co">#&gt;  [2,] -0.348229238+0.026193482i  0.783743606+0.00000000i</span></span>
<span><span class="co">#&gt;  [3,]  0.367730607+0.310242367i -0.022666936-0.15564715i</span></span>
<span><span class="co">#&gt;  [4,]  0.002932555-0.030541037i  0.109420309+0.46311484i</span></span>
<span><span class="co">#&gt;  [5,]  0.043105002-0.224844860i  0.042439378-0.01417827i</span></span>
<span><span class="co">#&gt;  [6,]  0.032216321+0.007191719i -0.220635858+0.06599916i</span></span>
<span><span class="co">#&gt;  [7,]  0.059296927+0.070003443i  0.006171201+0.01772586i</span></span>
<span><span class="co">#&gt;  [8,]  0.058221780-0.017435711i -0.188358244-0.05854553i</span></span>
<span><span class="co">#&gt;  [9,]  0.198921369-0.043625711i -0.006138109+0.01230184i</span></span>
<span><span class="co">#&gt; [10,]  0.058221780-0.017435711i -0.188358244-0.05854553i</span></span>
<span><span class="co">#&gt;                           [,8]            [,9]            [,10]</span></span>
<span><span class="co">#&gt;  [1,]  0.005488647+0.03369784i -0.025230343+0i -5.295556e-15+0i</span></span>
<span><span class="co">#&gt;  [2,]  0.783743606+0.00000000i -0.859571041+0i -9.481194e-01+0i</span></span>
<span><span class="co">#&gt;  [3,] -0.022666936+0.15564715i -0.134640449+0i  1.193352e-15+0i</span></span>
<span><span class="co">#&gt;  [4,]  0.109420309-0.46311484i  0.429511140+0i -4.231046e-15+0i</span></span>
<span><span class="co">#&gt;  [5,]  0.042439378+0.01417827i  0.036260783+0i  7.478823e-16+0i</span></span>
<span><span class="co">#&gt;  [6,] -0.220635858-0.06599916i -0.001425556+0i  1.156243e-01+0i</span></span>
<span><span class="co">#&gt;  [7,]  0.006171201-0.01772586i -0.004047100+0i  1.177518e-15+0i</span></span>
<span><span class="co">#&gt;  [8,] -0.188358244+0.05854553i  0.168073829+0i  1.849989e-01+0i</span></span>
<span><span class="co">#&gt;  [9,] -0.006138109-0.01230184i  0.007893352+0i  1.767433e-15+0i</span></span>
<span><span class="co">#&gt; [10,] -0.188358244+0.05854553i  0.168073829+0i  2.312486e-01+0i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $w</span></span>
<span><span class="co">#&gt;  [1] 0.2536597+0i 0.2112455+0i 0.3513929+0i 0.2104240+0i 0.3975824+0i</span></span>
<span><span class="co">#&gt;  [6] 0.2301052+0i 0.4339490+0i 0.2385797+0i 0.4583715+0i 0.2385797+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.demo.sens.html">spmm.demo.sens</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]          [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.10635498+0i 0.08124494+0i 0.13514559+0i 0.08092901+0i 0.15291005+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.04245892+0i 0.03243452+0i 0.05395267+0i 0.03230839+0i 0.06104458+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.07677440+0i 0.05864823+0i 0.09755745+0i 0.05842017+0i 0.11038107+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.04262467+0i 0.03256113+0i 0.05416329+0i 0.03243452+0i 0.06128289+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.06313900+0i 0.04823210+0i 0.08023091+0i 0.04804455+0i 0.09077701+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.03505438+0i 0.02677817+0i 0.04454371+0i 0.02667404+0i 0.05039884+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.05192530+0i 0.03966592+0i 0.06598163+0i 0.03951167+0i 0.07465471+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.02882861+0i 0.02202227+0i 0.03663259+0i 0.02193664+0i 0.04144783+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.24044125+0i 0.18367391+0i 0.30552940+0i 0.18295967+0i 0.34569027+0i</span></span>
<span><span class="co">#&gt; [10,] 0.13349150+0i 0.10197462+0i 0.16962803+0i 0.10157808+0i 0.19192510+0i</span></span>
<span><span class="co">#&gt;                [,6]          [,7]          [,8]          [,9]         [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.07970085+0i 0.16689665+0i 0.09175768+0i 0.17628954+0i 0.09175768+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.03181809+0i 0.06662830+0i 0.03663140+0i 0.07037812+0i 0.03663140+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.05753360+0i 0.12047757+0i 0.06623705+0i 0.12725801+0i 0.06623705+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.03194230+0i 0.06688840+0i 0.03677440+0i 0.07065286+0i 0.03677440+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.04731544+0i 0.09908034+0i 0.05447313+0i 0.10465655+0i 0.05447313+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.02626924+0i 0.05500879+0i 0.03024314+0i 0.05810467+0i 0.03024314+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.03891205+0i 0.08148333+0i 0.04479851+0i 0.08606919+0i 0.04479851+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.02160373+0i 0.04523904+0i 0.02487186+0i 0.04778508+0i 0.02487186+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.18018313+0i 0.37731038+0i 0.20744051+0i 0.39854528+0i 0.20744051+0i</span></span>
<span><span class="co">#&gt; [10,] 0.10003656+0i 0.20948039+0i 0.11516969+0i 0.22126988+0i 0.11516969+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.demo.elas.html">spmm.demo.elas</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]          [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.00000000+0i 0.00782231+0i 0.02168649+0i 0.01818108+0i 0.04907422+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.03406641+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.00000000+0i 0.04823210+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.00000000+0i 0.00000000+0i 0.04454371+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.03951167+0i 0.07465471+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt; [10,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;                [,6]           [,7]           [,8]         [,9]          [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.00000000+0i 0.005516956+0i 0.004853045+0i 0.0116549+0i 0.006066307+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.03122062+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.00000000+0i 0.037204434+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.00000000+0i 0.000000000+0i 0.170598367+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt; [10,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.1819716+0i 0.094715159+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.move.sens.html">spmm.move.sens</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]          [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.03115742+0i 0.02826418+0i 0.02594761+0i 0.05330264+0i 0.04316214+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.03810409+0i 0.03456579+0i 0.03173273+0i 0.06518667+0i 0.05278530+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.06711297+0i 0.06088095+0i 0.05589106+0i 0.11481368+0i 0.09297109+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.02489951+0i 0.02258737+0i 0.02073608+0i 0.04259689+0i 0.03449310+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.04767022+0i 0.04324363+0i 0.03969932+0i 0.08155195+0i 0.06603719+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.18599764+0i 0.16872613+0i 0.15489711+0i 0.31819592+0i 0.25766110+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.06934418+0i 0.06290497+0i 0.05774919+0i 0.11863073+0i 0.09606196+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.10683935+0i 0.09691838+0i 0.08897482+0i 0.18277568+0i 0.14800373+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.07870970+0i 0.07140081+0i 0.06554871+0i 0.13465281+0i 0.10903594+0i</span></span>
<span><span class="co">#&gt; [10,] 0.10683935+0i 0.09691838+0i 0.08897482+0i 0.18277568+0i 0.14800373+0i</span></span>
<span><span class="co">#&gt;                [,6]          [,7]          [,8]          [,9]         [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.02930512+0i 0.02584671+0i 0.05630249+0i 0.04883567+0i 0.02930512+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.03583881+0i 0.03160934+0i 0.06885535+0i 0.05972376+0i 0.03583881+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.06312312+0i 0.05567372+0i 0.12127536+0i 0.10519184+0i 0.06312312+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.02341924+0i 0.02065544+0i 0.04499423+0i 0.03902711+0i 0.02341924+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.04483624+0i 0.03954495+0i 0.08614167+0i 0.07471758+0i 0.04483624+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.17494012+0i 0.15429477+0i 0.33610388+0i 0.29152984+0i 0.17494012+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.06522169+0i 0.05752463+0i 0.12530723+0i 0.10868900+0i 0.06522169+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.10048777+0i 0.08862883+0i 0.19306223+0i 0.16745835+0i 0.10048777+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.07403042+0i 0.06529381+0i 0.14223102+0i 0.12336837+0i 0.07403042+0i</span></span>
<span><span class="co">#&gt; [10,] 0.10048777+0i 0.08862883+0i 0.19306223+0i 0.16745835+0i 0.10048777+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.move.elas.html">spmm.move.elas</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 [,1]          [,2]          [,3]          [,4]         [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.023436364+0i 0.01063005+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.009553864+0i 0.02166676+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.000000000+0i 0.00000000+0i 0.05605441+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.04272139+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0662302+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt; [10,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;               [,6]          [,7]         [,8]         [,9]        [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.1754514+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.0000000+0i 0.05769275+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.0000000+0i 0.00000000+0i 0.1936265+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.1237289+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt; [10,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.1007815+0i</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Caswell, H. (2001). Matrix Population Models: Construction, analysis,
and interpretation (2nd ed.). Sinauer Associates.</p>
<p>Gotelli, N. J. (1991). Metapopulation models: the rescue effect, the
propagate rain, and the core-satellite hypothesis. <em>The American
Naturalist</em> 138(3):768–776.</p>
<p>Gotelli, N. J. (2008). A Primer of Ecology (4th ed.). Sinauer
Associates.</p>
<p>Hunter, C. M. and Caswell, H. (2005). The use of vec-permutation
matrix in spatial matrix population models. <em>Ecological
Modelling</em> 188:15–21.</p>
<p>Lebreton, J. D. (1996). Demographic models for subdivided
populations: the renewal equation approach. <em>Theoretical Population
Biology</em> 49:291–313.</p>
<p>Leslie, P. H. (1945). On the use of matrices in certain population
mathematics. <em>Biometrika</em> 33:183–212.</p>
<p>Morris, W. F., and Doak, D. F. (2003). Quantitative Conservation
Biology: Theory and practice of population viability analysis. Sinauer
Associates.</p>
<p>Roth, G. and Caswell, H. (2016). Hyperstate matrix models: extending
demographic state spaces to higher dimensions. <em>Methods in Ecology
and Evolution</em> 7:1438–1450.</p>
<p>Wootton, J.T., and Bell, D.A. (1992). A metapopulation model of the
peregrine falcon in California: viability and management strategies.
<em>Ecological Applications</em> 2:307-–321.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Caleb A. Aldrdge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
