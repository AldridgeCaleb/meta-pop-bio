<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metapopbio">
<title>Getting started with the metapopbio package • metapopbio</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with the metapopbio package">
<meta property="og:description" content="metapopbio">
<meta property="og:image" content="https://aldridgecaleb.github.io/meta-pop-bio/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metapopbio</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting-started.html">Getting started with the metapopbio package</a>
    <a class="dropdown-item" href="../articles/using-auto.spmm.html">Using auto.spmm</a>
    <a class="dropdown-item" href="../articles/using-spmm.readxl.html">Using the spmm.readxl funciton</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AldridgeCaleb/meta-pop-bio/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting started with the metapopbio package</h1>
                        <h4 data-toc-skip class="author">Caleb A.
Aldridge</h4>
            
            <h4 data-toc-skip class="date">2023-10-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AldridgeCaleb/meta-pop-bio/blob/HEAD/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github("AldridgeCaleb/meta-pop-bio")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aldridgecaleb.github.io/meta-pop-bio/">metapopbio</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: openxlsx</span></span>
<span><span class="co">#&gt; Loading required package: zeallot</span></span></code></pre></div>
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>The <a href="https://github.com/AldridgeCaleb/meta-pop-bio" class="external-link"><code>metapopbio</code></a>
package is inspired by and complements the functionalities of the <a href="https://cran.r-project.org/web/packages/popbio/index.html" class="external-link"><code>popbio</code></a>
package. Users can construct and analyze projection matrix models for
metapopulations classified by age or stage and located in distinct
patches.</p>
<p>The functionality to date is largely based on Hunter and Caswell
(2005) to construct and analyze spatial matrix population models using
the vec-permutation matrix. This model extends the Leslie matrix (Leslie
1945) to include dispersal rates between patches. An analogous approach
was taken by Lebreton (1996) and called the “renewal equation
approach.”</p>
<p>Current plans include support for classic metapopulation models of
Gotelli (1991; 2008) <em>and others</em>, i.e., <span class="math inline">\(\frac{df}{dt}=p_{i}(1-f)-p_{e}f\)</span>, <span class="math inline">\(\frac{df}{dt}=p_{i}(1-f)-ef(1-f)\)</span>, <span class="math inline">\(\frac{df}{dt}=if(1-f)-p_{e}f\)</span>, and <span class="math inline">\(\frac{df}{dt}=if(1-f)-ef(1-f)\)</span>, and
hyperstate matrix models (Roth and Caswell 2016). Additionally, Hanski’s
(1994) incidence function <span class="math inline">\(J_{i}=\frac{1}{1+\Bigl(1+\bigl[\frac{y'}{S_{i}}\bigr]^2\Bigr)\frac{e}{A_{i}^x}}\)</span>
and a metapopulation version of the
<strong>S</strong>usceptible–<strong>I</strong>nfected–<strong>R</strong>ecovered
model (SIR model) are also being considered. Other suggestions can be
submitted in email to <a href="mailto:caleb.a.aldridge@gmail.com" class="email">caleb.a.aldridge@gmail.com</a> or as an issue on the
package’s GitHub repository (<a href="https://github.com/AldridgeCaleb/meta-pop-bio/issues" class="external-link uri">https://github.com/AldridgeCaleb/meta-pop-bio/issues</a>).</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The following two examples come from Hunter and Caswell (2005) using
peregrine falcon (<em>Falco peregrinus</em>) data from Wootton and Bell
(1992) and black-headed gull (<em>Larus ridibundus</em>) data from
Lebreton (1996).</p>
<div class="section level3">
<h3 id="the-peregrine-falcon">The peregrine falcon<a class="anchor" aria-label="anchor" href="#the-peregrine-falcon"></a>
</h3>
<div class="section level5">
<h5 id="patches-stages-and-grouping">1. Patches, stages, and grouping<a class="anchor" aria-label="anchor" href="#patches-stages-and-grouping"></a>
</h5>
<p>First, we define the number of patches (discrete locations) and
stages (age, class, or size). In this example there are two “patches”,
Northern California and Southern California, and two life-stages,
juvenile and adult. We also group or will project stages within
patches<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;If we were to group or project patches within stages,
the groupby object would contain “stages”.&lt;/p&gt;"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_patches</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">n_stages</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-vec-permutation-matrix">2. Construct vec-permutation matrix<a class="anchor" aria-label="anchor" href="#construct-vec-permutation-matrix"></a>
</h5>
<p>Next, we construct the vec-permutation matrix. Essentially, the
vec-permutation matrix helps us relate demographic and dispersal
parameters so that populations in patches are projected considering
births, immigration, deaths, and emigration (BIDE) or recruitment,
immigration, survival, and emigration (RISE). The
<code><a href="../reference/vec.perm.html">metapopbio::vec.perm</a></code> function helps us to easily construct
a vec-permutation matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">P</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/vec.perm.html">vec.perm</a></span><span class="op">(</span>n_stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>           n_patches <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>           group_by <span class="op">=</span> <span class="va">group_by</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="demographic-parameters-for-each-patch">3. Demographic parameters for each patch<a class="anchor" aria-label="anchor" href="#demographic-parameters-for-each-patch"></a>
</h5>
<p>We now specify transition probabilities from one stage to the next
(survival <em>s</em> and recruitment <em>r</em>). Numbers in object
names indicate patch then stage. Only adults are assumed to
reproduce.</p>
<p>Northern first.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Northern</span></span>
<span><span class="va">f11</span> <span class="op">&lt;-</span> <span class="fl">0.00</span> </span>
<span><span class="va">f12</span> <span class="op">&lt;-</span> <span class="fl">0.26</span></span>
<span><span class="va">s11</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span>
<span><span class="va">s12</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></code></pre></div>
<p>Now Southern.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Southern</span></span>
<span><span class="va">f21</span> <span class="op">&lt;-</span> <span class="fl">0.00</span></span>
<span><span class="va">f22</span> <span class="op">&lt;-</span> <span class="fl">0.19</span>  </span>
<span><span class="va">s21</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span>
<span><span class="va">s22</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="a--structure-demographic-parameters">4a. Structure demographic parameters<a class="anchor" aria-label="anchor" href="#a--structure-demographic-parameters"></a>
</h5>
<p>Now we will construct demographic (Leslise-style) matrices for each
of the patches. This is just placing the demographic parameters from
above into an ordered matrices for analysis and projecting.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Northern</span></span>
<span><span class="op">(</span><span class="va">B1x</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f11</span>, <span class="va">f12</span>, <span class="va">s11</span>, <span class="va">s12</span><span class="op">)</span>,</span>
<span>         nrow <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         ncol <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.26</span></span>
<span><span class="co">#&gt; [2,] 0.72 0.77</span></span>
<span><span class="co"># Southern</span></span>
<span><span class="op">(</span><span class="va">B2x</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f21</span>, <span class="va">f22</span>, <span class="va">s21</span>, <span class="va">s22</span><span class="op">)</span>,</span>
<span>         nrow <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         ncol <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.19</span></span>
<span><span class="co">#&gt; [2,] 0.72 0.77</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="b--construct-block-diagonal-matrix">4b. Construct block diagonal matrix<a class="anchor" aria-label="anchor" href="#b--construct-block-diagonal-matrix"></a>
</h5>
<p>Along with the vec-permutation matrix, spatial matrix population
models use a matrix of matrices for analysis and projection of
population demographics and movement. We accomplish this using the
<code><a href="../reference/blk.diag.html">metapopbio::blk.diag</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">BB</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">B1x</span>, <span class="va">B2x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.26 0.00 0.00</span></span>
<span><span class="co">#&gt; [2,] 0.72 0.77 0.00 0.00</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.00 0.00 0.19</span></span>
<span><span class="co">#&gt; [4,] 0.00 0.00 0.72 0.77</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="structure-movement-parameters">5. Structure movement parameters<a class="anchor" aria-label="anchor" href="#structure-movement-parameters"></a>
</h5>
<p>Similar to the above, we will construct movement or dispersal
matrices for each of the stages. This is just placing movement
parameters into an ordered matrices for analysis and projecting. We
assume that only juveniles disperse, therefore an identity matrix is
specified for adult movement.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Juveniles</span></span>
<span><span class="va">dx1</span> <span class="op">&lt;-</span> <span class="fl">0.27</span> </span>
<span><span class="va">dx2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">dx1</span></span>
<span><span class="op">(</span><span class="va">Mx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dx2</span>, <span class="va">dx1</span>, <span class="va">dx1</span>, <span class="va">dx2</span><span class="op">)</span>,</span>
<span>              nrow <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>              ncol <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>              byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.73 0.27</span></span>
<span><span class="co">#&gt; [2,] 0.27 0.73</span></span>
<span><span class="co"># Adults</span></span>
<span><span class="op">(</span><span class="va">Mx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">n_patches</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    0</span></span>
<span><span class="co">#&gt; [2,]    0    1</span></span>
<span><span class="co"># Block diagonal matrix</span></span>
<span><span class="op">(</span><span class="va">MM</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Mx1</span>, <span class="va">Mx2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.73 0.27    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.27 0.73    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.00    1    0</span></span>
<span><span class="co">#&gt; [4,] 0.00 0.00    0    1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-projection-matrix">6. Construct projection matrix<a class="anchor" aria-label="anchor" href="#construct-projection-matrix"></a>
</h5>
<p>Now we can use the vec-permutation matrix and block diagonal matrices
to construct a population projection matrix. This is accomplished
through matrix multiplication. The order of matrices is very important
(see Hunter and Caswell 2005 or function documentation for more detail),
but the <code><a href="../reference/spmm.project.matrix.html">metapopbio::spmm.project.matrix</a></code> function makes it
much more convenient and reduces the probability of calculation errors.
All that’s needed is to specify the grouping (structure) for the
projection (stages within patches here) and the order type between
demographic and movement / dispersal processes (here, dispersal then
demographics), then supply the matrices we have constructed (P, BB, and
MM).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span>
<span><span class="va">lh_order</span> <span class="op">&lt;-</span> <span class="st">"move"</span></span>
<span><span class="op">(</span><span class="va">A</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.matrix.html">spmm.project.matrix</a></span><span class="op">(</span></span>
<span>    P <span class="op">=</span> <span class="va">P</span>,</span>
<span>    BB <span class="op">=</span> <span class="va">BB</span>,</span>
<span>    MM <span class="op">=</span> <span class="va">MM</span>,</span>
<span>    group_by <span class="op">=</span> <span class="va">group_by</span>,</span>
<span>    lh_order <span class="op">=</span> <span class="va">lh_order</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1] [,2]   [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.0000 0.26 0.0000 0.00</span></span>
<span><span class="co">#&gt; [2,] 0.5256 0.77 0.1944 0.00</span></span>
<span><span class="co">#&gt; [3,] 0.0000 0.00 0.0000 0.19</span></span>
<span><span class="co">#&gt; [4,] 0.1944 0.00 0.5256 0.77</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="project">7. Project<a class="anchor" aria-label="anchor" href="#project"></a>
</h5>
<p>Now we can project populations into future time steps. First, we have
to indicate the starting, initial, or current sizes of each stage by
patch, or vice versa if grouping by stages. An added step is to comment
on the vector which ensures projection calculations are correct. The
numbers for <strong>n</strong> below were retrieved from Table 1 of
Wootton and Bell (1992).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">60</span>, <span class="fl">19</span>,  <span class="co"># Northern patch adults then juveniles</span></span>
<span>  <span class="fl">29</span>, <span class="fl">20</span>   <span class="co"># Southern patch adults then juveniles</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/comment.html" class="external-link">comment</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"patches"</span>  <span class="co"># vector attr for group_by </span></span></code></pre></div>
<p>Now we indicate the number of time steps we would like to
project.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_timesteps</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></code></pre></div>
<p>And, finally we can project stages within patches using the
<code><a href="../reference/spmm.project.html">metapopbio::spmm.project</a></code> function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span></span>
<span>  <span class="va">projs</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.html">spmm.project</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="va">n</span>,</span>
<span>      A <span class="op">=</span> <span class="va">A</span>,</span>
<span>      n_timesteps <span class="op">=</span> <span class="va">n_timesteps</span>,</span>
<span>      n_stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>      n_patches <span class="op">=</span> <span class="va">n_patches</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Deterministic spatial matrix model projections for patches structured population vector and movement then demography A projection matrix."</span></span>
<span><span class="co">#&gt;       1       2         3         4         5         6         7         8</span></span>
<span><span class="co">#&gt; [1,] 60  4.9400 13.468936 11.238229 10.900330 10.270267  9.726175  9.200632</span></span>
<span><span class="co">#&gt; [2,] 19 51.8036 43.223956 41.924348 39.501028 37.408367 35.387046 33.476641</span></span>
<span><span class="co">#&gt; [3,] 29  3.8000  8.038216  6.751373  6.498775  6.093371  5.743504  5.410349</span></span>
<span><span class="co">#&gt; [4,] 20 42.3064 35.533544 34.204076 32.070372 30.228967 28.475520 26.835704</span></span>
<span><span class="co">#&gt;              9        10        11        12        13        14        15</span></span>
<span><span class="co">#&gt; [1,]  8.703927  8.232806  7.786417  7.363528  6.963014  6.583779  6.224767</span></span>
<span><span class="co">#&gt; [2,] 31.664637 29.947758 28.321261 26.780825 25.322228 23.941413 22.634479</span></span>
<span><span class="co">#&gt; [3,]  5.098784  4.806197  4.531445  4.273266  4.030542  3.802242  3.587418</span></span>
<span><span class="co">#&gt; [4,] 25.295775 23.849711 22.490872 21.213378 20.011800 18.881148 17.816829</span></span>
<span><span class="co">#&gt;             16        17        18        19        20        21        22</span></span>
<span><span class="co">#&gt; [1,]  5.884964  5.563397  5.259133  4.971280  4.698988  4.441444  4.197874</span></span>
<span><span class="co">#&gt; [2,] 21.397680 20.227434 19.120309 18.073033 17.082479 16.145670 15.259770</span></span>
<span><span class="co">#&gt; [3,]  3.385198  3.194774  3.015402  2.846392  2.687104  2.536941  2.395351</span></span>
<span><span class="co">#&gt; [4,] 16.814600 15.870539 14.981013 14.142651 13.352322 12.607113 11.904310</span></span>
<span><span class="co">#&gt;             23        24        25        26        27        28        29</span></span>
<span><span class="co">#&gt; [1,]  3.967540  3.749741  3.543810  3.349114  3.165049  2.991046  2.826563</span></span>
<span><span class="co">#&gt; [2,] 14.422082 13.630040 12.881207 12.173267 11.504025 10.871395 10.273402</span></span>
<span><span class="co">#&gt; [3,]  2.261819  2.135863  2.017034  1.904912  1.799106  1.699246  1.604990</span></span>
<span><span class="co">#&gt; [4,] 11.241382 10.615966 10.025853  9.468976  8.943401  8.447315  7.979015</span></span>
<span><span class="co">#&gt;            30       31       32       33       34       35       36       37</span></span>
<span><span class="co">#&gt; [1,] 2.671084 2.524124 2.385221 2.253936 2.129857 2.012590 1.901764 1.797028</span></span>
<span><span class="co">#&gt; [2,] 9.708171 9.173926 8.668986 8.191757 7.740730 7.314477 6.911645 6.530955</span></span>
<span><span class="co">#&gt; [3,] 1.516013 1.432013 1.352704 1.277820 1.207108 1.140333 1.077271 1.017714</span></span>
<span><span class="co">#&gt; [4,] 7.536908 7.119495 6.725366 6.353200 6.001751 5.669849 5.356390 5.060337</span></span>
<span><span class="co">#&gt;            38        39       40       41       42        43        44</span></span>
<span><span class="co">#&gt; [1,] 1.698048 1.6045112 1.516118 1.432588 1.353654 1.2790640 1.2085798</span></span>
<span><span class="co">#&gt; [2,] 6.171197 5.8312246 5.509954 5.206362 4.919477 4.6483838 4.3922152</span></span>
<span><span class="co">#&gt; [3,] 0.961464 0.9083353 0.858153 0.810752 0.765977 0.7236813 0.6837267</span></span>
<span><span class="co">#&gt; [4,] 4.780712 4.5165945 4.267116 4.031458 3.808849 3.5985615 3.3999093</span></span>
<span><span class="co">#&gt;             45        46        47        48        49        50        51</span></span>
<span><span class="co">#&gt; [1,] 1.1419760 1.0790394 1.0195688 0.9633735 0.9102736 0.8600988 0.8126882</span></span>
<span><span class="co">#&gt; [2,] 4.1501517 3.9214184 3.7052828 3.5010523 3.3080723 3.1257239 2.9534223</span></span>
<span><span class="co">#&gt; [3,] 0.6459828 0.6103265 0.5766419 0.5448193 0.5147554 0.4863527 0.4595189</span></span>
<span><span class="co">#&gt; [4,] 3.2122448 3.0349571 2.8674699 2.7092389 2.5597508 2.4185208 2.2850911</span></span>
<span><span class="co">#&gt;             52        53        54        55        56        57        58</span></span>
<span><span class="co">#&gt; [1,] 0.7678898 0.7255598 0.6855623 0.6477690 0.6120585 0.5783162 0.5464335</span></span>
<span><span class="co">#&gt; [2,] 2.7906146 2.6367782 2.4914194 2.3540713 2.2242929 2.1016673 1.9858004</span></span>
<span><span class="co">#&gt; [3,] 0.4341673 0.4102157 0.3875865 0.3662067 0.3460070 0.3269223 0.3088908</span></span>
<span><span class="co">#&gt; [4,] 2.1590299 2.0399292 1.9274036 1.8210896 1.7206435 1.6257410 1.5360756</span></span>
<span><span class="co">#&gt;             59        60        61        62        63        64        65</span></span>
<span><span class="co">#&gt; [1,] 0.5163081 0.4878432 0.4609474 0.4355341 0.4115217 0.3888330 0.3673951</span></span>
<span><span class="co">#&gt; [2,] 1.8763202 1.7728746 1.6751312 1.5827758 1.4955116 1.4130580 1.3351499</span></span>
<span><span class="co">#&gt; [3,] 0.2918544 0.2757580 0.2605498 0.2461806 0.2326041 0.2197767 0.2076568</span></span>
<span><span class="co">#&gt; [4,] 1.4513579 1.3713145 1.2956873 1.2242323 1.1567192 1.0929304 1.0326601</span></span>
<span><span class="co">#&gt;             66        67        68        69        70        71        72</span></span>
<span><span class="co">#&gt; [1,] 0.3471390 0.3279996 0.3099153 0.2928280 0.2766828 0.2614277 0.2470136</span></span>
<span><span class="co">#&gt; [2,] 1.2615367 1.1919819 1.1262616 1.0641645 1.0054910 0.9500523 0.8976701</span></span>
<span><span class="co">#&gt; [3,] 0.1962054 0.1853857 0.1751628 0.1655037 0.1563773 0.1477543 0.1396068</span></span>
<span><span class="co">#&gt; [4,] 0.9757143 0.9219094 0.8710721 0.8230386 0.7776542 0.7347728 0.6942563</span></span>
<span><span class="co">#&gt;             73        74        75        76        77        78         79</span></span>
<span><span class="co">#&gt; [1,] 0.2333942 0.2205257 0.2083667 0.1968781 0.1860229 0.1757662 0.16607498</span></span>
<span><span class="co">#&gt; [2,] 0.8481759 0.8014105 0.7572235 0.7154727 0.6760238 0.6387499 0.60353119</span></span>
<span><span class="co">#&gt; [3,] 0.1319087 0.1246351 0.1177626 0.1112691 0.1051337 0.0993366 0.09385919</span></span>
<span><span class="co">#&gt; [4,] 0.6559741 0.6198031 0.5856268 0.5533351 0.5228242 0.4939957 0.46675699</span></span>
<span><span class="co">#&gt;              80         81         82         83         84         85</span></span>
<span><span class="co">#&gt; [1,] 0.15691811 0.14826611 0.14009114 0.13236691 0.12506856 0.11817261</span></span>
<span><span class="co">#&gt; [2,] 0.57025426 0.53881207 0.50910349 0.48103292 0.45451006 0.42944958</span></span>
<span><span class="co">#&gt; [3,] 0.08868383 0.08379385 0.07917351 0.07480795 0.07068311 0.06678572</span></span>
<span><span class="co">#&gt; [4,] 0.44102025 0.41670269 0.39372605 0.37201637 0.35150379 0.33212229</span></span>
<span><span class="co">#&gt;              86        87         88         89         90         91</span></span>
<span><span class="co">#&gt; [1,] 0.11165689 0.1055004 0.09968340 0.09418711 0.08899386 0.08408696</span></span>
<span><span class="co">#&gt; [2,] 0.40577084 0.3833977 0.36225810 0.34228409 0.32341139 0.30557928</span></span>
<span><span class="co">#&gt; [3,] 0.06310324 0.0596238 0.05633623 0.05322993 0.05029491 0.04752173</span></span>
<span><span class="co">#&gt; [4,] 0.31380950 0.2965065 0.28015754 0.26471008 0.25011439 0.23632349</span></span>
<span><span class="co">#&gt;              92         93         94         95         96         97</span></span>
<span><span class="co">#&gt; [1,] 0.07945061 0.07506990 0.07093072 0.06701977 0.06332446 0.05983290</span></span>
<span><span class="co">#&gt; [2,] 0.28873038 0.27281048 0.25776836 0.24355562 0.23012653 0.21743789</span></span>
<span><span class="co">#&gt; [3,] 0.04490146 0.04242567 0.04008640 0.03787610 0.03578769 0.03381442</span></span>
<span><span class="co">#&gt; [4,] 0.22329302 0.21098103 0.19934792 0.18835624 0.17797063 0.16815767</span></span>
<span><span class="co">#&gt;              98         99        100</span></span>
<span><span class="co">#&gt; [1,] 0.05653385 0.05341671 0.05047143</span></span>
<span><span class="co">#&gt; [2,] 0.20544887 0.19412090 0.18341752</span></span>
<span><span class="co">#&gt; [3,] 0.03194996 0.03018830 0.02852377</span></span>
<span><span class="co">#&gt; [4,] 0.15888578 0.15012513 0.14184752</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="plotting">8. Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h5>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stage_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Juv."</span>, <span class="st">"Adults"</span><span class="op">)</span></span>
<span><span class="va">patch_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"North"</span>, <span class="st">"South"</span><span class="op">)</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.plot.html">spmm.plot</a></span><span class="op">(</span></span>
<span>  projections <span class="op">=</span> <span class="va">projs</span>,</span>
<span>  ylabs <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>  xlabs <span class="op">=</span> <span class="st">"Years"</span>,</span>
<span>  stage_names <span class="op">=</span> <span class="va">stage_names</span>,</span>
<span>  patch_names <span class="op">=</span> <span class="va">patch_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-13-1.png" width="700"><img src="getting-started_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="sensitivity-and-elasticity-analyses">9. Sensitivity and elasticity analyses<a class="anchor" aria-label="anchor" href="#sensitivity-and-elasticity-analyses"></a>
</h5>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.matrix.sens.html">spmm.project.matrix.sens</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]      [,2]       [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.10867018 0.3949167 0.06141440 0.3054113</span></span>
<span><span class="co">#&gt; [2,] 0.16158007 0.5871958 0.09131616 0.4541115</span></span>
<span><span class="co">#&gt; [3,] 0.08404076 0.3054113 0.04749521 0.2361917</span></span>
<span><span class="co">#&gt; [4,] 0.09131616 0.3318507 0.05160687 0.2566388</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.eig.lambda.html">spmm.eig.lambda</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt; $eig</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1]  0.94486220  0.85353422 -0.17486220 -0.08353422</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;           [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.2111729 -0.1455690 -0.6997575  0.5681052</span></span>
<span><span class="co">#&gt; [2,] 0.7674202 -0.4778775  0.4706197 -0.1825239</span></span>
<span><span class="co">#&gt; [3,] 0.1193433  0.1882302 -0.3954644 -0.7345971</span></span>
<span><span class="co">#&gt; [4,] 0.5934892  0.8455839  0.3639567  0.3229684</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda</span></span>
<span><span class="co">#&gt; [1] 0.9448622</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $v</span></span>
<span><span class="co">#&gt; [1] 0.2111729 0.7674202 0.1193433 0.5934892</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $eig_t</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1]  0.94486220  0.85353422 -0.17486220 -0.08353422</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] -0.4706197 -0.1825239 -0.7674202 -0.4778775</span></span>
<span><span class="co">#&gt; [2,] -0.6997575 -0.5681052  0.2111729  0.1455690</span></span>
<span><span class="co">#&gt; [3,] -0.3639567  0.3229684 -0.5934892  0.8455839</span></span>
<span><span class="co">#&gt; [4,] -0.3954644  0.7345971  0.1193433 -0.1882302</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $w</span></span>
<span><span class="co">#&gt; [1] -0.4706197 -0.6997575 -0.3639567 -0.3954644</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.demo.sens.html">spmm.demo.sens</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.10202024 0.16158007 0.09069071 0.09131616</span></span>
<span><span class="co">#&gt; [2,] 0.37075026 0.58719578 0.32957777 0.33185072</span></span>
<span><span class="co">#&gt; [3,] 0.05765622 0.09131616 0.05125339 0.05160687</span></span>
<span><span class="co">#&gt; [4,] 0.28672202 0.45411152 0.25488102 0.25663882</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.demo.elas.html">spmm.demo.elas</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]       [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.0000000 0.04446238 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,] 0.2825176 0.47852560 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [3,] 0.0000000 0.00000000 0.0000000 0.0103775</span></span>
<span><span class="co">#&gt; [4,] 0.0000000 0.00000000 0.1942234 0.2091436</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.move.sens.html">spmm.move.sens</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.2843400 0.2198961 0.4227810 0.2389325</span></span>
<span><span class="co">#&gt; [2,] 0.2198961 0.1700581 0.3269603 0.1847800</span></span>
<span><span class="co">#&gt; [3,] 0.3323401 0.2570173 0.4941516 0.2792673</span></span>
<span><span class="co">#&gt; [4,] 0.2468354 0.1908917 0.3670159 0.2074172</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.move.elas.html">spmm.move.elas</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]       [,2]     [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.21968095 0.06283663 0.000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,] 0.06283663 0.13138675 0.000000 0.0000000</span></span>
<span><span class="co">#&gt; [3,] 0.00000000 0.00000000 0.522988 0.0000000</span></span>
<span><span class="co">#&gt; [4,] 0.00000000 0.00000000 0.000000 0.2195211</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="the-black-headed-gull">The black-headed gull<a class="anchor" aria-label="anchor" href="#the-black-headed-gull"></a>
</h3>
<p>Fewer comments are provided for this example but it should be noted
that the grouping (structure of n) is by stages in this example. The
life-cycle order remains the same, i.e., movement then demographics
(only juveniles assumed to disperse).</p>
<div class="section level5">
<h5 id="patches-stages-and-grouping-1">1. Patches, stages, and grouping<a class="anchor" aria-label="anchor" href="#patches-stages-and-grouping-1"></a>
</h5>
<p>First, we define the number of patches and stages (age, class, or
size). In this example there are two “patches” and five life-stages. We
also group or will project patches within stages.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_patches</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">n_stages</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"stages"</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-vec-permutation-matrix-1">2. Construct vec-permutation matrix<a class="anchor" aria-label="anchor" href="#construct-vec-permutation-matrix-1"></a>
</h5>
<p>Next, we construct the vec-permutation matrix.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">P</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/vec.perm.html">vec.perm</a></span><span class="op">(</span>n_stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>           n_patches <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>           group_by <span class="op">=</span> <span class="va">group_by</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,]    1    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [2,]    0    0    0    0    0    1    0    0    0     0</span></span>
<span><span class="co">#&gt;  [3,]    0    1    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [4,]    0    0    0    0    0    0    1    0    0     0</span></span>
<span><span class="co">#&gt;  [5,]    0    0    1    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [6,]    0    0    0    0    0    0    0    1    0     0</span></span>
<span><span class="co">#&gt;  [7,]    0    0    0    1    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [8,]    0    0    0    0    0    0    0    0    1     0</span></span>
<span><span class="co">#&gt;  [9,]    0    0    0    0    1    0    0    0    0     0</span></span>
<span><span class="co">#&gt; [10,]    0    0    0    0    0    0    0    0    0     1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="define-and-structure-demographic-parameters">3. Define and structure Demographic parameters<a class="anchor" aria-label="anchor" href="#define-and-structure-demographic-parameters"></a>
</h5>
<p>We now specify transition probabilities from one stage to the next.
Only adults are assumed to reproduce and differential among adult
stages. We will specify demographic parameters and structure the
(Leslie-style) matrices for each patch simultaneously.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B1x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">0.096</span>, <span class="fl">0.160</span>, <span class="fl">0.224</span>, <span class="fl">0.320</span>,</span>
<span>                <span class="fl">0.800</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.820</span><span class="op">)</span>,</span>
<span>              nrow <span class="op">=</span> <span class="va">n_stages</span>, ncol <span class="op">=</span> <span class="va">n_stages</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">B2x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">0.100</span>, <span class="fl">0.160</span>, <span class="fl">0.200</span>, <span class="fl">0.200</span>,</span>
<span>                <span class="fl">0.800</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>                <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.820</span>, <span class="fl">0.820</span><span class="op">)</span>,</span>
<span>              nrow <span class="op">=</span> <span class="va">n_stages</span>, ncol <span class="op">=</span> <span class="va">n_stages</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-block-diagonal-matrix">4. Construct block diagonal matrix<a class="anchor" aria-label="anchor" href="#construct-block-diagonal-matrix"></a>
</h5>
<p>Along with the vec-permutation matrix, spatial matrix population
models use a matrix of matrices for analysis and projection of
population demographics and movement. We accomplish this using the
<code><a href="../reference/blk.diag.html">metapopbio::blk.diag</a></code> function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">BB</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">B1x</span>, <span class="va">B2x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1]  [,2] [,3]  [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,]  0.0 0.096 0.16 0.224 0.32  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [2,]  0.8 0.000 0.00 0.000 0.00  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [3,]  0.0 0.820 0.00 0.000 0.00  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [4,]  0.0 0.000 0.82 0.000 0.00  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [5,]  0.0 0.000 0.00 0.820 0.82  0.0 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [6,]  0.0 0.000 0.00 0.000 0.00  0.0 0.10 0.16 0.20  0.20</span></span>
<span><span class="co">#&gt;  [7,]  0.0 0.000 0.00 0.000 0.00  0.8 0.00 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [8,]  0.0 0.000 0.00 0.000 0.00  0.0 0.82 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [9,]  0.0 0.000 0.00 0.000 0.00  0.0 0.00 0.82 0.00  0.00</span></span>
<span><span class="co">#&gt; [10,]  0.0 0.000 0.00 0.000 0.00  0.0 0.00 0.00 0.82  0.82</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="structure-movement-parameters-1">5. Structure movement parameters<a class="anchor" aria-label="anchor" href="#structure-movement-parameters-1"></a>
</h5>
<p>Similar to the above, we will construct movement or dispersal
matrices for each of the stages. This is just placing movement
parameters into an ordered matrices for analysis and projecting. We
assume that only juveniles disperse, therefore an identity matrix is
specified for adult movement.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Juveniles</span></span>
<span><span class="va">Mx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.375</span>, <span class="fl">0.25</span>, <span class="fl">0.625</span><span class="op">)</span>,</span>
<span>              nrow <span class="op">=</span> <span class="va">n_patches</span>, ncol <span class="op">=</span> <span class="va">n_patches</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Adults</span></span>
<span><span class="va">Mx5</span> <span class="op">&lt;-</span> <span class="va">Mx4</span> <span class="op">&lt;-</span> <span class="va">Mx3</span> <span class="op">&lt;-</span> <span class="va">Mx2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">n_patches</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Block diagonal matrix</span></span>
<span><span class="op">(</span><span class="va">MM</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Mx1</span>, <span class="va">Mx2</span>, <span class="va">Mx3</span>, <span class="va">Mx4</span>, <span class="va">Mx5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1]  [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.75 0.375    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [2,] 0.25 0.625    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [3,] 0.00 0.000    1    0    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [4,] 0.00 0.000    0    1    0    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [5,] 0.00 0.000    0    0    1    0    0    0    0     0</span></span>
<span><span class="co">#&gt;  [6,] 0.00 0.000    0    0    0    1    0    0    0     0</span></span>
<span><span class="co">#&gt;  [7,] 0.00 0.000    0    0    0    0    1    0    0     0</span></span>
<span><span class="co">#&gt;  [8,] 0.00 0.000    0    0    0    0    0    1    0     0</span></span>
<span><span class="co">#&gt;  [9,] 0.00 0.000    0    0    0    0    0    0    1     0</span></span>
<span><span class="co">#&gt; [10,] 0.00 0.000    0    0    0    0    0    0    0     1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-projection-matrix-1">6. Construct projection matrix<a class="anchor" aria-label="anchor" href="#construct-projection-matrix-1"></a>
</h5>
<p>Now we can use the vec-permutation matrix and block diagonal matrices
to construct a population projection matrix. This is accomplished
through matrix multiplication. The order of matrices is very important
(see Hunter and Caswell 2005 or function documentation for more detail),
but the <code><a href="../reference/spmm.project.matrix.html">metapopbio::spmm.project.matrix</a></code> function makes it
much more convenient and reduces the probability of calculation errors.
All that’s needed is to specify the grouping (structure) for the
projection (stages within patches here) and the order type between
demographic and movement / dispersal processes (here, dispersal then
demographics), then supply the matrices we have constructed (P, BB, and
MM).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"stages"</span></span>
<span><span class="va">lh_order</span> <span class="op">&lt;-</span> <span class="st">"move"</span></span>
<span><span class="op">(</span><span class="va">A</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.matrix.html">spmm.project.matrix</a></span><span class="op">(</span></span>
<span>    P <span class="op">=</span> <span class="va">P</span>,</span>
<span>    BB <span class="op">=</span> <span class="va">BB</span>,</span>
<span>    MM <span class="op">=</span> <span class="va">MM</span>,</span>
<span>    group_by <span class="op">=</span> <span class="va">group_by</span>,</span>
<span>    lh_order <span class="op">=</span> <span class="va">lh_order</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2]  [,3] [,4] [,5] [,6]  [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt;  [1,]  0.0  0.0 0.096 0.00 0.16 0.00 0.224 0.00 0.32  0.00</span></span>
<span><span class="co">#&gt;  [2,]  0.0  0.0 0.000 0.10 0.00 0.16 0.000 0.20 0.00  0.20</span></span>
<span><span class="co">#&gt;  [3,]  0.6  0.3 0.000 0.00 0.00 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [4,]  0.2  0.5 0.000 0.00 0.00 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [5,]  0.0  0.0 0.820 0.00 0.00 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [6,]  0.0  0.0 0.000 0.82 0.00 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [7,]  0.0  0.0 0.000 0.00 0.82 0.00 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [8,]  0.0  0.0 0.000 0.00 0.00 0.82 0.000 0.00 0.00  0.00</span></span>
<span><span class="co">#&gt;  [9,]  0.0  0.0 0.000 0.00 0.00 0.00 0.820 0.00 0.82  0.00</span></span>
<span><span class="co">#&gt; [10,]  0.0  0.0 0.000 0.00 0.00 0.00 0.000 0.82 0.00  0.82</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="project-1">7. Project<a class="anchor" aria-label="anchor" href="#project-1"></a>
</h5>
<p>Now we can project populations into future time steps. First, we have
to indicate the starting, initial, or current sizes of each patch by
stage. I have made these up as they were not avilable in Hunter and
Morris (2005) nor Lebreton (1996). An added step is to comment on the
vector which ensures projection calculations are correct.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">100</span>, <span class="fl">90</span>,  <span class="co"># stage 1</span></span>
<span>  <span class="fl">78</span>, <span class="fl">77</span>,  <span class="co"># stage 2</span></span>
<span>  <span class="fl">50</span>, <span class="fl">48</span>,  <span class="co"># stage 3</span></span>
<span>  <span class="fl">40</span>, <span class="fl">36</span>,  <span class="co"># stage 4</span></span>
<span>  <span class="fl">29</span>, <span class="fl">28</span>  <span class="co"># stage 5</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/comment.html" class="external-link">comment</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"stages"</span>  <span class="co"># vector attr for group_by </span></span></code></pre></div>
<p>Now we indicate the number of time steps we would like to
project.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_timesteps</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></code></pre></div>
<p>And, finally we can project stages within patches using the
<code><a href="../reference/spmm.project.html">metapopbio::spmm.project</a></code> function.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span></span>
<span>  <span class="va">projs</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.html">spmm.project</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="va">n</span>,</span>
<span>      A <span class="op">=</span> <span class="va">A</span>,</span>
<span>      n_timesteps <span class="op">=</span> <span class="va">n_timesteps</span>,</span>
<span>      n_stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>      n_patches <span class="op">=</span> <span class="va">n_patches</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Deterministic spatial matrix model projections for stages structured population vector and movement then demography A projection matrix."</span></span>
<span><span class="co">#&gt;        1      2       3        4        5        6        7        8        9</span></span>
<span><span class="co">#&gt; [1,] 100 33.728 45.8752 51.52188 55.27576 57.16619 56.41182 56.61106 57.01488</span></span>
<span><span class="co">#&gt; [2,]  90 28.180 34.9704 36.02828 34.98257 33.38963 32.34447 31.50141 30.72830</span></span>
<span><span class="co">#&gt; [3,]  78 87.000 28.6908 38.01624 41.72161 43.66023 44.31660 43.55043 43.41706</span></span>
<span><span class="co">#&gt; [4,]  77 65.000 20.8356 26.66024 28.31852 28.54643 28.12805 27.45460 27.07292</span></span>
<span><span class="co">#&gt; [5,]  50 63.960 71.3400 23.52646 31.17332 34.21172 35.80139 36.33961 35.71136</span></span>
<span><span class="co">#&gt; [6,]  48 63.140 53.3000 17.08519 21.86140 23.22118 23.40808 23.06500 22.51277</span></span>
<span><span class="co">#&gt;            10       11       12       13       14       15       16       17</span></span>
<span><span class="co">#&gt; [1,] 57.42386 57.75500 57.98370 58.16642 58.31441 58.43059 58.51630 58.57352</span></span>
<span><span class="co">#&gt; [2,] 30.01180 29.35679 28.76673 28.23493 27.75363 27.31674 26.91939 26.55750</span></span>
<span><span class="co">#&gt; [3,] 43.42742 43.45786 43.46004 43.42024 43.37033 43.31474 43.25337 43.18560</span></span>
<span><span class="co">#&gt; [4,] 26.76713 26.49067 26.22939 25.98011 25.75075 25.53970 25.34449 25.16296</span></span>
<span><span class="co">#&gt; [5,] 35.60199 35.61048 35.63544 35.63723 35.60459 35.56367 35.51808 35.46777</span></span>
<span><span class="co">#&gt; [6,] 22.19979 21.94904 21.72235 21.50810 21.30369 21.11561 20.94255 20.78248</span></span>
<span><span class="co">#&gt;            18       19       20       21       22       23       24       25</span></span>
<span><span class="co">#&gt; [1,] 58.60568 58.61578 58.60635 58.57953 58.53724 58.48118 58.41291 58.33379</span></span>
<span><span class="co">#&gt; [2,] 26.22731 25.92542 25.64878 25.39469 25.16071 24.94470 24.74475 24.55913</span></span>
<span><span class="co">#&gt; [3,] 43.11136 43.03160 42.94709 42.85844 42.76613 42.67056 42.57212 42.47117</span></span>
<span><span class="co">#&gt; [4,] 24.99345 24.83479 24.68587 24.54566 24.41325 24.28780 24.16859 24.05496</span></span>
<span><span class="co">#&gt; [5,] 35.41219 35.35132 35.28591 35.21662 35.14392 35.06822 34.98986 34.90914</span></span>
<span><span class="co">#&gt; [6,] 20.63362 20.49463 20.36453 20.24241 20.12744 20.01886 19.91600 19.81824</span></span>
<span><span class="co">#&gt;            26       27       28       29       30       31       32       33</span></span>
<span><span class="co">#&gt; [1,] 58.24506 58.14781 58.04301 57.93152 57.81413 57.69152 57.56431 57.43305</span></span>
<span><span class="co">#&gt; [2,] 24.38632 24.22496 24.07383 23.93184 23.79803 23.67153 23.55158 23.43748</span></span>
<span><span class="co">#&gt; [3,] 42.36802 42.26294 42.15617 42.04795 41.93846 41.82788 41.71637 41.60406</span></span>
<span><span class="co">#&gt; [4,] 23.94633 23.84217 23.74204 23.64551 23.55222 23.46184 23.37407 23.28865</span></span>
<span><span class="co">#&gt; [5,] 34.82636 34.74177 34.65561 34.56806 34.47932 34.38954 34.29886 34.20742</span></span>
<span><span class="co">#&gt; [6,] 19.72506 19.63599 19.55058 19.46847 19.38932 19.31282 19.23871 19.16674</span></span>
<span><span class="co">#&gt;            34       35       36       37       38       39       40       41</span></span>
<span><span class="co">#&gt; [1,] 57.29823 57.16028 57.01960 56.87653 56.73138 56.58443 56.43592 56.28607</span></span>
<span><span class="co">#&gt; [2,] 23.32863 23.22449 23.12455 23.02839 22.93562 22.84590 22.75891 22.67437</span></span>
<span><span class="co">#&gt; [3,] 41.49107 41.37753 41.26351 41.14913 41.03444 40.91952 40.80443 40.68922</span></span>
<span><span class="co">#&gt; [4,] 23.20535 23.12396 23.04430 22.96619 22.88950 22.81409 22.73983 22.66664</span></span>
<span><span class="co">#&gt; [5,] 34.11533 34.02268 33.92957 33.83608 33.74228 33.64824 33.55400 33.45963</span></span>
<span><span class="co">#&gt; [6,] 19.09669 19.02839 18.96165 18.89633 18.83228 18.76939 18.70755 18.64666</span></span>
<span><span class="co">#&gt;            42       43       44       45       46       47       48       49</span></span>
<span><span class="co">#&gt; [1,] 56.13508 55.98312 55.83035 55.67690 55.52290 55.36846 55.21367 55.05862</span></span>
<span><span class="co">#&gt; [2,] 22.59206 22.51174 22.43322 22.35632 22.28089 22.20680 22.13391 22.06211</span></span>
<span><span class="co">#&gt; [3,] 40.57396 40.45867 40.34340 40.22818 40.11304 39.99801 39.88311 39.76837</span></span>
<span><span class="co">#&gt; [4,] 22.59440 22.52305 22.45249 22.38268 22.31354 22.24503 22.17709 22.10969</span></span>
<span><span class="co">#&gt; [5,] 33.36516 33.27064 33.17611 33.08158 32.98710 32.89269 32.79837 32.70415</span></span>
<span><span class="co">#&gt; [6,] 18.58664 18.52741 18.46890 18.41104 18.35380 18.29710 18.24092 18.18521</span></span>
<span><span class="co">#&gt;            50</span></span>
<span><span class="co">#&gt; [1,] 54.90340</span></span>
<span><span class="co">#&gt; [2,] 21.99132</span></span>
<span><span class="co">#&gt; [3,] 39.65381</span></span>
<span><span class="co">#&gt; [4,] 22.04278</span></span>
<span><span class="co">#&gt; [5,] 32.61007</span></span>
<span><span class="co">#&gt; [6,] 18.12994</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="plotting-1">8. Plotting<a class="anchor" aria-label="anchor" href="#plotting-1"></a>
</h5>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stage_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">patch_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.plot.html">spmm.plot</a></span><span class="op">(</span></span>
<span>  projections <span class="op">=</span> <span class="va">projs</span>,</span>
<span>  ylabs <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>  xlabs <span class="op">=</span> <span class="st">"Years"</span>,</span>
<span>  stage_names <span class="op">=</span> <span class="va">stage_names</span>,</span>
<span>  patch_names <span class="op">=</span> <span class="va">patch_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-24-1.png" width="700"><img src="getting-started_files/figure-html/unnamed-chunk-24-2.png" width="700"><img src="getting-started_files/figure-html/unnamed-chunk-24-3.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="sensitivity-and-elasticity-analyses-1">9. Sensitivity and elasticity analyses<a class="anchor" aria-label="anchor" href="#sensitivity-and-elasticity-analyses-1"></a>
</h5>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.project.matrix.sens.html">spmm.project.matrix.sens</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]          [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.09755745+0i 0.03894678+0i 0.07042373+0i 0.03909882+0i 0.05791623+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.08124494+0i 0.03243452+0i 0.05864823+0i 0.03256113+0i 0.04823210+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.13514559+0i 0.05395267+0i 0.09755745+0i 0.05416329+0i 0.08023091+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.08092901+0i 0.03230839+0i 0.05842017+0i 0.03243452+0i 0.04804455+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.15291005+0i 0.06104458+0i 0.11038107+0i 0.06128289+0i 0.09077701+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.08849839+0i 0.03533023+0i 0.06388427+0i 0.03546815+0i 0.05253820+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.16689665+0i 0.06662830+0i 0.12047757+0i 0.06688840+0i 0.09908034+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.09175768+0i 0.03663140+0i 0.06623705+0i 0.03677440+0i 0.05447313+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.17628954+0i 0.07037812+0i 0.12725801+0i 0.07065286+0i 0.10465655+0i</span></span>
<span><span class="co">#&gt; [10,] 0.09175768+0i 0.03663140+0i 0.06623705+0i 0.03677440+0i 0.05447313+0i</span></span>
<span><span class="co">#&gt;                [,6]          [,7]          [,8]         [,9]        [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.03215474+0i 0.04763011+0i 0.02644394+0i 0.2205523+0i 0.1224493+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.02677817+0i 0.03966592+0i 0.02202227+0i 0.1836739+0i 0.1019746+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.04454371+0i 0.06598163+0i 0.03663259+0i 0.3055294+0i 0.1696280+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.02667404+0i 0.03951167+0i 0.02193664+0i 0.1829597+0i 0.1015781+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.05039884+0i 0.07465471+0i 0.04144783+0i 0.3456903+0i 0.1919251+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.02916889+0i 0.04320724+0i 0.02398839+0i 0.2000721+0i 0.1110788+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.05500879+0i 0.08148333+0i 0.04523904+0i 0.3773104+0i 0.2094804+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.03024314+0i 0.04479851+0i 0.02487186+0i 0.2074405+0i 0.1151697+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.05810467+0i 0.08606919+0i 0.04778508+0i 0.3985453+0i 0.2212699+0i</span></span>
<span><span class="co">#&gt; [10,] 0.03024314+0i 0.04479851+0i 0.02487186+0i 0.2074405+0i 0.1151697+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.eig.lambda.html">spmm.eig.lambda</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt; $eig</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt;  [1]  9.970859e-01+0.000000e+00i  8.919222e-01+0.000000e+00i</span></span>
<span><span class="co">#&gt;  [3]  2.182849e-01+4.025870e-01i  2.182849e-01-4.025870e-01i</span></span>
<span><span class="co">#&gt;  [5] -3.024940e-01+2.461757e-01i -3.024940e-01-2.461757e-01i</span></span>
<span><span class="co">#&gt;  [7]  6.112978e-02+2.358721e-01i  6.112978e-02-2.358721e-01i</span></span>
<span><span class="co">#&gt;  [9] -2.028494e-01+0.000000e+00i -2.481725e-15+0.000000e+00i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;                 [,1]           [,2]                    [,3]</span></span>
<span><span class="co">#&gt;  [1,] -0.32790653+0i -0.18212972+0i  0.11605642-0.07487059i</span></span>
<span><span class="co">#&gt;  [2,] -0.13090649+0i  0.22690373+0i  0.00607663+0.01670070i</span></span>
<span><span class="co">#&gt;  [3,] -0.23670566+0i -0.04619989+0i -0.00224182-0.17870968i</span></span>
<span><span class="co">#&gt;  [4,] -0.13141752+0i  0.08635946+0i  0.01460604-0.05728283i</span></span>
<span><span class="co">#&gt;  [5,] -0.19466592+0i -0.04247446+0i -0.28321501-0.14899452i</span></span>
<span><span class="co">#&gt;  [6,] -0.10807732+0i  0.07939566+0i -0.07770140-0.07188011i</span></span>
<span><span class="co">#&gt;  [7,] -0.16009259+0i -0.03904943+0i -0.47624334+0.31863815i</span></span>
<span><span class="co">#&gt;  [8,] -0.08888242+0i  0.07299341+0i -0.17946017+0.06096001i</span></span>
<span><span class="co">#&gt;  [9,] -0.74131229+0i -0.44521053+0i  0.64901068+0.00000000i</span></span>
<span><span class="co">#&gt; [10,] -0.41157200+0i  0.83221273+0i  0.20733303+0.05564490i</span></span>
<span><span class="co">#&gt;                          [,4]                     [,5]                     [,6]</span></span>
<span><span class="co">#&gt;  [1,]  0.11605642+0.07487059i  0.05022988+0.092774312i  0.05022988-0.092774312i</span></span>
<span><span class="co">#&gt;  [2,]  0.00607663-0.01670070i -0.00445866-0.000487239i -0.00445866+0.000487239i</span></span>
<span><span class="co">#&gt;  [3,] -0.00224182+0.17870968i  0.03257850-0.157022550i  0.03257850+0.157022550i</span></span>
<span><span class="co">#&gt;  [4,]  0.01460604+0.05728283i  0.01409087-0.049066797i  0.01409087+0.049066797i</span></span>
<span><span class="co">#&gt;  [5,] -0.28321501+0.14899452i -0.26151751+0.212828160i -0.26151751-0.212828160i</span></span>
<span><span class="co">#&gt;  [6,] -0.07770140+0.07188011i -0.08809695+0.061315092i -0.08809695-0.061315092i</span></span>
<span><span class="co">#&gt;  [7,] -0.47624334-0.31863815i  0.70892098+0.000000000i  0.70892098+0.000000000i</span></span>
<span><span class="co">#&gt;  [8,] -0.17946017-0.06096001i  0.22503737+0.016927103i  0.22503737-0.016927103i</span></span>
<span><span class="co">#&gt;  [9,]  0.64901068+0.00000000i -0.49411266-0.108364506i -0.49411266+0.108364506i</span></span>
<span><span class="co">#&gt; [10,]  0.20733303-0.05564490i -0.15426192-0.046196910i -0.15426192+0.046196910i</span></span>
<span><span class="co">#&gt;                           [,7]                     [,8]            [,9]</span></span>
<span><span class="co">#&gt;  [1,]  0.014698188+0.01044128i  0.014698188-0.01044128i  0.010988584+0i</span></span>
<span><span class="co">#&gt;  [2,] -0.031370628-0.01839136i -0.031370628+0.01839136i -0.023369498+0i</span></span>
<span><span class="co">#&gt;  [3,]  0.002359263+0.00312244i  0.002359263-0.00312244i  0.002059156+0i</span></span>
<span><span class="co">#&gt;  [4,] -0.041358939+0.04331760i -0.041358939-0.04331760i  0.046768853+0i</span></span>
<span><span class="co">#&gt;  [5,]  0.012163687-0.00504948i  0.012163687+0.00504948i -0.008323952+0i</span></span>
<span><span class="co">#&gt;  [6,]  0.106195671+0.17130489i  0.106195671-0.17130489i -0.189058814+0i</span></span>
<span><span class="co">#&gt;  [7,] -0.006180033-0.04388822i -0.006180033+0.04388822i  0.033648815+0i</span></span>
<span><span class="co">#&gt;  [8,]  0.647709984-0.20132129i  0.647709984+0.20132129i  0.764252980+0i</span></span>
<span><span class="co">#&gt;  [9,] -0.007352067+0.04513841i -0.007352067-0.04513841i -0.026975652+0i</span></span>
<span><span class="co">#&gt; [10,] -0.699885399+0.00000000i -0.699885399+0.00000000i -0.612687917+0i</span></span>
<span><span class="co">#&gt;                  [,10]</span></span>
<span><span class="co">#&gt;  [1,] -2.152632e-16+0i</span></span>
<span><span class="co">#&gt;  [2,]  5.083145e-17+0i</span></span>
<span><span class="co">#&gt;  [3,]  8.319549e-17+0i</span></span>
<span><span class="co">#&gt;  [4,] -1.860247e-16+0i</span></span>
<span><span class="co">#&gt;  [5,] -3.341436e-16+0i</span></span>
<span><span class="co">#&gt;  [6,]  1.981519e-15+0i</span></span>
<span><span class="co">#&gt;  [7,] -1.381459e-15+0i</span></span>
<span><span class="co">#&gt;  [8,] -7.071068e-01+0i</span></span>
<span><span class="co">#&gt;  [9,]  1.464485e-15+0i</span></span>
<span><span class="co">#&gt; [10,]  7.071068e-01+0i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda</span></span>
<span><span class="co">#&gt; [1] 0.9970859</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $v</span></span>
<span><span class="co">#&gt;  [1] -0.32790653+0i -0.13090649+0i -0.23670566+0i -0.13141752+0i -0.19466592+0i</span></span>
<span><span class="co">#&gt;  [6] -0.10807732+0i -0.16009259+0i -0.08888242+0i -0.74131229+0i -0.41157200+0i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $eig_t</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt;  [1]  9.970859e-01+0.000000e+00i  8.919222e-01+0.000000e+00i</span></span>
<span><span class="co">#&gt;  [3]  2.182849e-01+4.025870e-01i  2.182849e-01-4.025870e-01i</span></span>
<span><span class="co">#&gt;  [5] -3.024940e-01+2.461757e-01i -3.024940e-01-2.461757e-01i</span></span>
<span><span class="co">#&gt;  [7]  6.112978e-02+2.358721e-01i  6.112978e-02-2.358721e-01i</span></span>
<span><span class="co">#&gt;  [9] -2.028494e-01+0.000000e+00i -1.560002e-16+0.000000e+00i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;               [,1]           [,2]                    [,3]</span></span>
<span><span class="co">#&gt;  [1,] 0.2536597+0i  0.05633004+0i -0.62139103+0.00000000i</span></span>
<span><span class="co">#&gt;  [2,] 0.2112455+0i -0.15794294+0i -0.29776448-0.07991527i</span></span>
<span><span class="co">#&gt;  [3,] 0.3513929+0i  0.22206487+0i -0.25523002-0.40674126i</span></span>
<span><span class="co">#&gt;  [4,] 0.2104240+0i -0.41498457+0i  0.08748875-0.03059607i</span></span>
<span><span class="co">#&gt;  [5,] 0.3975824+0i  0.23494746+0i  0.20449932-0.23358264i</span></span>
<span><span class="co">#&gt;  [6,] 0.2301052+0i -0.43212154+0i  0.07462378+0.04455451i</span></span>
<span><span class="co">#&gt;  [7,] 0.4339490+0i  0.24456348+0i  0.29036465+0.03822100i</span></span>
<span><span class="co">#&gt;  [8,] 0.2385797+0i -0.43920480+0i  0.05609084+0.06409096i</span></span>
<span><span class="co">#&gt;  [9,] 0.4583715+0i  0.25062643+0i  0.22827625+0.15273184i</span></span>
<span><span class="co">#&gt; [10,] 0.2385797+0i -0.43920480+0i  0.05609084+0.06409096i</span></span>
<span><span class="co">#&gt;                          [,4]                    [,5]                    [,6]</span></span>
<span><span class="co">#&gt;  [1,] -0.62139103+0.00000000i -0.73133636+0.00000000i -0.73133636+0.00000000i</span></span>
<span><span class="co">#&gt;  [2,] -0.29776448+0.07991527i -0.34822924-0.02619348i -0.34822924+0.02619348i</span></span>
<span><span class="co">#&gt;  [3,] -0.25523002+0.40674126i  0.36773061-0.31024237i  0.36773061+0.31024237i</span></span>
<span><span class="co">#&gt;  [4,]  0.08748875+0.03059607i  0.00293255+0.03054104i  0.00293255-0.03054104i</span></span>
<span><span class="co">#&gt;  [5,]  0.20449932+0.23358264i  0.04310500+0.22484486i  0.04310500-0.22484486i</span></span>
<span><span class="co">#&gt;  [6,]  0.07462378-0.04455451i  0.03221632-0.00719172i  0.03221632+0.00719172i</span></span>
<span><span class="co">#&gt;  [7,]  0.29036465-0.03822100i  0.05929693-0.07000344i  0.05929693+0.07000344i</span></span>
<span><span class="co">#&gt;  [8,]  0.05609084-0.06409096i  0.05822178+0.01743571i  0.05822178-0.01743571i</span></span>
<span><span class="co">#&gt;  [9,]  0.22827625-0.15273184i  0.19892137+0.04362571i  0.19892137-0.04362571i</span></span>
<span><span class="co">#&gt; [10,]  0.05609084-0.06409096i  0.05822178+0.01743571i  0.05822178-0.01743571i</span></span>
<span><span class="co">#&gt;                          [,7]                    [,8]            [,9]</span></span>
<span><span class="co">#&gt;  [1,]  0.00548865-0.03369784i  0.00548865+0.03369784i -0.025230343+0i</span></span>
<span><span class="co">#&gt;  [2,]  0.78374361+0.00000000i  0.78374361+0.00000000i -0.859571041+0i</span></span>
<span><span class="co">#&gt;  [3,] -0.02266694-0.15564715i -0.02266694+0.15564715i -0.134640449+0i</span></span>
<span><span class="co">#&gt;  [4,]  0.10942031+0.46311484i  0.10942031-0.46311484i  0.429511140+0i</span></span>
<span><span class="co">#&gt;  [5,]  0.04243938-0.01417827i  0.04243938+0.01417827i  0.036260783+0i</span></span>
<span><span class="co">#&gt;  [6,] -0.22063586+0.06599916i -0.22063586-0.06599916i -0.001425556+0i</span></span>
<span><span class="co">#&gt;  [7,]  0.00617120+0.01772586i  0.00617120-0.01772586i -0.004047100+0i</span></span>
<span><span class="co">#&gt;  [8,] -0.18835824-0.05854553i -0.18835824+0.05854553i  0.168073829+0i</span></span>
<span><span class="co">#&gt;  [9,] -0.00613811+0.01230184i -0.00613811-0.01230184i  0.007893352+0i</span></span>
<span><span class="co">#&gt; [10,] -0.18835824-0.05854553i -0.18835824+0.05854553i  0.168073829+0i</span></span>
<span><span class="co">#&gt;                  [,10]</span></span>
<span><span class="co">#&gt;  [1,] -1.095150e-16+0i</span></span>
<span><span class="co">#&gt;  [2,] -9.481194e-01+0i</span></span>
<span><span class="co">#&gt;  [3,] -1.888905e-16+0i</span></span>
<span><span class="co">#&gt;  [4,]  2.562543e-16+0i</span></span>
<span><span class="co">#&gt;  [5,]  2.341254e-16+0i</span></span>
<span><span class="co">#&gt;  [6,]  1.156243e-01+0i</span></span>
<span><span class="co">#&gt;  [7,] -5.441816e-16+0i</span></span>
<span><span class="co">#&gt;  [8,]  1.849989e-01+0i</span></span>
<span><span class="co">#&gt;  [9,]  2.425013e-16+0i</span></span>
<span><span class="co">#&gt; [10,]  2.312486e-01+0i</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $w</span></span>
<span><span class="co">#&gt;  [1] 0.2536597+0i 0.2112455+0i 0.3513929+0i 0.2104240+0i 0.3975824+0i</span></span>
<span><span class="co">#&gt;  [6] 0.2301052+0i 0.4339490+0i 0.2385797+0i 0.4583715+0i 0.2385797+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.demo.sens.html">spmm.demo.sens</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]          [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.10635498+0i 0.08124494+0i 0.13514559+0i 0.08092901+0i 0.15291005+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.04245892+0i 0.03243452+0i 0.05395267+0i 0.03230839+0i 0.06104458+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.07677440+0i 0.05864823+0i 0.09755745+0i 0.05842017+0i 0.11038107+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.04262467+0i 0.03256113+0i 0.05416329+0i 0.03243452+0i 0.06128289+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.06313900+0i 0.04823210+0i 0.08023091+0i 0.04804455+0i 0.09077701+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.03505438+0i 0.02677817+0i 0.04454371+0i 0.02667404+0i 0.05039884+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.05192530+0i 0.03966592+0i 0.06598163+0i 0.03951167+0i 0.07465471+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.02882861+0i 0.02202227+0i 0.03663259+0i 0.02193664+0i 0.04144783+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.24044125+0i 0.18367391+0i 0.30552940+0i 0.18295967+0i 0.34569027+0i</span></span>
<span><span class="co">#&gt; [10,] 0.13349150+0i 0.10197462+0i 0.16962803+0i 0.10157808+0i 0.19192510+0i</span></span>
<span><span class="co">#&gt;                [,6]          [,7]          [,8]          [,9]         [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.07970085+0i 0.16689665+0i 0.09175768+0i 0.17628954+0i 0.09175768+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.03181809+0i 0.06662830+0i 0.03663140+0i 0.07037812+0i 0.03663140+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.05753360+0i 0.12047757+0i 0.06623705+0i 0.12725801+0i 0.06623705+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.03194230+0i 0.06688840+0i 0.03677440+0i 0.07065286+0i 0.03677440+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.04731544+0i 0.09908034+0i 0.05447313+0i 0.10465655+0i 0.05447313+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.02626924+0i 0.05500879+0i 0.03024314+0i 0.05810467+0i 0.03024314+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.03891205+0i 0.08148333+0i 0.04479851+0i 0.08606919+0i 0.04479851+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.02160373+0i 0.04523904+0i 0.02487186+0i 0.04778508+0i 0.02487186+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.18018313+0i 0.37731038+0i 0.20744051+0i 0.39854528+0i 0.20744051+0i</span></span>
<span><span class="co">#&gt; [10,] 0.10003656+0i 0.20948039+0i 0.11516969+0i 0.22126988+0i 0.11516969+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.demo.elas.html">spmm.demo.elas</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]          [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.00000000+0i 0.00782231+0i 0.02168649+0i 0.01818108+0i 0.04907422+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.03406641+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.00000000+0i 0.04823210+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.00000000+0i 0.00000000+0i 0.04454371+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.03951167+0i 0.07465471+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt; [10,] 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i</span></span>
<span><span class="co">#&gt;                [,6]           [,7]           [,8]         [,9]          [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.00000000+0i 0.005516956+0i 0.004853045+0i 0.0116549+0i 0.006066307+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.03122062+0i 0.000000000+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.00000000+0i 0.037204434+0i 0.000000000+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.00000000+0i 0.000000000+0i 0.170598367+0i 0.0000000+0i 0.000000000+0i</span></span>
<span><span class="co">#&gt; [10,] 0.00000000+0i 0.000000000+0i 0.000000000+0i 0.1819716+0i 0.094715159+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.move.sens.html">spmm.move.sens</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]          [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.03115742+0i 0.02826418+0i 0.02594761+0i 0.05330264+0i 0.04316214+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.03810409+0i 0.03456579+0i 0.03173273+0i 0.06518667+0i 0.05278530+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.06711297+0i 0.06088095+0i 0.05589106+0i 0.11481368+0i 0.09297109+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.02489951+0i 0.02258737+0i 0.02073608+0i 0.04259689+0i 0.03449310+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.04767022+0i 0.04324363+0i 0.03969932+0i 0.08155195+0i 0.06603719+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.18599764+0i 0.16872613+0i 0.15489711+0i 0.31819592+0i 0.25766110+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.06934418+0i 0.06290497+0i 0.05774919+0i 0.11863073+0i 0.09606196+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.10683935+0i 0.09691838+0i 0.08897482+0i 0.18277568+0i 0.14800373+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.07870970+0i 0.07140081+0i 0.06554871+0i 0.13465281+0i 0.10903594+0i</span></span>
<span><span class="co">#&gt; [10,] 0.10683935+0i 0.09691838+0i 0.08897482+0i 0.18277568+0i 0.14800373+0i</span></span>
<span><span class="co">#&gt;                [,6]          [,7]          [,8]          [,9]         [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.02930512+0i 0.02584671+0i 0.05630249+0i 0.04883567+0i 0.02930512+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.03583881+0i 0.03160934+0i 0.06885535+0i 0.05972376+0i 0.03583881+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.06312312+0i 0.05567372+0i 0.12127536+0i 0.10519184+0i 0.06312312+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.02341924+0i 0.02065544+0i 0.04499423+0i 0.03902711+0i 0.02341924+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.04483624+0i 0.03954495+0i 0.08614167+0i 0.07471758+0i 0.04483624+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.17494012+0i 0.15429477+0i 0.33610388+0i 0.29152984+0i 0.17494012+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.06522169+0i 0.05752463+0i 0.12530723+0i 0.10868900+0i 0.06522169+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.10048777+0i 0.08862883+0i 0.19306223+0i 0.16745835+0i 0.10048777+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.07403042+0i 0.06529381+0i 0.14223102+0i 0.12336837+0i 0.07403042+0i</span></span>
<span><span class="co">#&gt; [10,] 0.10048777+0i 0.08862883+0i 0.19306223+0i 0.16745835+0i 0.10048777+0i</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/spmm.move.elas.html">spmm.move.elas</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 [,1]          [,2]          [,3]          [,4]         [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.023436364+0i 0.01063005+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.009553864+0i 0.02166676+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.000000000+0i 0.00000000+0i 0.05605441+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.04272139+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0662302+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt; [10,] 0.000000000+0i 0.00000000+0i 0.00000000+0i 0.00000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;               [,6]          [,7]         [,8]         [,9]        [,10]</span></span>
<span><span class="co">#&gt;  [1,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [2,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [3,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [4,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [5,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [6,] 0.1754514+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [7,] 0.0000000+0i 0.05769275+0i 0.0000000+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [8,] 0.0000000+0i 0.00000000+0i 0.1936265+0i 0.0000000+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt;  [9,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.1237289+0i 0.0000000+0i</span></span>
<span><span class="co">#&gt; [10,] 0.0000000+0i 0.00000000+0i 0.0000000+0i 0.0000000+0i 0.1007815+0i</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Caswell, H. (2001). Matrix Population Models: Construction, analysis,
and interpretation (2nd ed.). Sinauer Associates.</p>
<p>Gotelli, N. J. (1991). Metapopulation models: the rescue effect, the
propagate rain, and the core-satellite hypothesis. <em>The American
Naturalist</em> 138(3):768–776.</p>
<p>Gotelli, N. J. (2008). A Primer of Ecology (4th ed.). Sinauer
Associates.</p>
<p>Hunter, C. M. and Caswell, H. (2005). The use of vec-permutation
matrix in spatial matrix population models. <em>Ecological
Modelling</em> 188:15–21.</p>
<p>Lebreton, J. D. (1996). Demographic models for subdivided
populations: the renewal equation approach. <em>Theoretical Population
Biology</em> 49:291–313.</p>
<p>Leslie, P. H. (1945). On the use of matrices in certain population
mathematics. <em>Biometrika</em> 33:183–212.</p>
<p>Morris, W. F., and Doak, D. F. (2003). Quantitative Conservation
Biology: Theory and practice of population viability analysis. Sinauer
Associates.</p>
<p>Roth, G. and Caswell, H. (2016). Hyperstate matrix models: extending
demographic state spaces to higher dimensions. <em>Methods in Ecology
and Evolution</em> 7:1438–1450.</p>
<p>Wootton, J.T., and Bell, D.A. (1992). A metapopulation model of the
peregrine falcon in California: viability and management strategies.
<em>Ecological Applications</em> 2:307-–321.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Caleb A. Aldrdge.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
