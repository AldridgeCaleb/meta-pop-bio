<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>deterministic projection of spatial matrix population model — spmm.project • metapopbio</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="deterministic projection of spatial matrix population model — spmm.project"><meta name="description" content="Produces deterministic future population sizes of stages s in patches p.
Projections can be ordered with demography then movement (dispersal) or vice
versa using population vectors arranged by patches or stages as described in
Hunter and Caswell (2005) and Lebreton (1996)."><meta property="og:description" content="Produces deterministic future population sizes of stages s in patches p.
Projections can be ordered with demography then movement (dispersal) or vice
versa using population vectors arranged by patches or stages as described in
Hunter and Caswell (2005) and Lebreton (1996)."><meta property="og:image" content="https://aldridgecaleb.github.io/meta-pop-bio/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metapopbio</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting-started.html">Getting started with the metapopbio package</a></li>
    <li><a class="dropdown-item" href="../articles/using-auto.spmm.html">Using auto.spmm</a></li>
    <li><a class="dropdown-item" href="../articles/using-spmm.readxl.html">Using the spmm.readxl funciton</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AldridgeCaleb/meta-pop-bio/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>deterministic projection of spatial matrix population model</h1>
      <small class="dont-index">Source: <a href="https://github.com/AldridgeCaleb/meta-pop-bio/blob/main/R/spmm.project.R" class="external-link"><code>R/spmm.project.R</code></a></small>
      <div class="d-none name"><code>spmm.project.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Produces deterministic future population sizes of stages s in patches p.
Projections can be ordered with demography then movement (dispersal) or vice
versa using population vectors arranged by patches or stages as described in
Hunter and Caswell (2005) and Lebreton (1996).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spmm.project</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">A</span>,</span>
<span>  <span class="va">n_timesteps</span>,</span>
<span>  <span class="va">n_stages</span>,</span>
<span>  <span class="va">n_patches</span>,</span>
<span>  ddf <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  harv <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  deter <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">P</span>,</span>
<span>  <span class="va">BB</span>,</span>
<span>  <span class="va">MM</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Vector of stage and patch starting values. If structure for `n` is
by patches, the vector sould order values for each stage within each patch
and "stack" patches. If structure for `n` is by stages, the vector sould
order values for each patch within each stage and "stack" stages.</p></dd>


<dt id="arg-a">A<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>The spatial population projection matrix constructed from the
vec-permutation matrix P, block diagonal demographic matrix BB, and
block diagonal Movement matrix MM (see `spmm.project.matrix` for more details).</p></dd>


<dt id="arg-n-timesteps">n_timesteps<a class="anchor" aria-label="anchor" href="#arg-n-timesteps"></a></dt>
<dd><p>The number of time steps into the future that should be
projected.</p></dd>


<dt id="arg-n-stages">n_stages<a class="anchor" aria-label="anchor" href="#arg-n-stages"></a></dt>
<dd><p>The number of stages (rows) in the metapopulation state matrix
N.</p></dd>


<dt id="arg-n-patches">n_patches<a class="anchor" aria-label="anchor" href="#arg-n-patches"></a></dt>
<dd><p>The number of patches (columns) in the metapopulation state
matrix N.</p></dd>


<dt id="arg-ddf">ddf<a class="anchor" aria-label="anchor" href="#arg-ddf"></a></dt>
<dd><p>Density-dependent function parameters (see `?spmm.ddf.params`)</p></dd>


<dt id="arg-harv">harv<a class="anchor" aria-label="anchor" href="#arg-harv"></a></dt>
<dd><p>Additive (harvest) mortality. Can be element (applies to all) or a
vector of added mortality equal in length to demographic matrix of row ×
column.</p></dd>


<dt id="arg-deter">deter<a class="anchor" aria-label="anchor" href="#arg-deter"></a></dt>
<dd><p>A list of three vectors. The first two, `from` and `to`, identify
where deterrence of movement is made. The third, `d`, contains the proportions
by which movement is deterred. Currently deterrence is assumed equal for all
stages.</p></dd>


<dt id="arg-p">P<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>vec-permutation matrix – required if ddf, harv, or deter given</p></dd>


<dt id="arg-bb">BB<a class="anchor" aria-label="anchor" href="#arg-bb"></a></dt>
<dd><p>block diagonal demographic matrix – required if ddf, harv, or deter given</p></dd>


<dt id="arg-mm">MM<a class="anchor" aria-label="anchor" href="#arg-mm"></a></dt>
<dd><p>block diagonal movement (dispersal) matrix – required if ddf, harv,
or deter given</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Ensure that the structural lh_orders of population vector `n` and projection
matrix `A` are the same. Otherwise, projections may produce incorrect values!</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988). The New S Language.
Wadsworth &amp; Brooks/Cole.</p>
<p>Wootton, J.T., and Bell, D.A. (1992). A metapopulation model of the peregrine
falcon in California: viability and management strategies. Ecological
Applications 2:307–321.</p>
<p>Lebreton, J. D. (1996). Demographic models for subdivided populations: the
renewal equation approach. Theoretical Population Biology 49:291–313.</p>
<p>Caswell, H. (2001). Matrix Population Models: Construction, analysis, and
interpretation (2nd ed.). Sinauer Associates.</p>
<p>Morris, W. F., and Doak, D. F. (2003). Quantitative Conservation Biology:
Theory and practice of population viability analysis. Sinauer Associates.</p>
<p>Hunter, C. M. and Caswell, H. (2005). The use of vec-permutation matrix in
spatial matrix population models. Ecological Modelling 188:15–21.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Peregrine falcon example from Hunter and Caswell (2005), data from Wootton</span></span></span>
<span class="r-in"><span><span class="co"># and Bell (1992). Continues example from `spmm.project.matrix`.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the number of patches and stages</span></span></span>
<span class="r-in"><span><span class="va">n_patches</span> <span class="op">&lt;-</span> <span class="fl">2</span>  <span class="co"># northern = 1x; southern = 2x</span></span></span>
<span class="r-in"><span><span class="va">n_stages</span> <span class="op">&lt;-</span> <span class="fl">2</span>  <span class="co"># juvenile = x1; adult = x2</span></span></span>
<span class="r-in"><span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Construct vec-permutation matrix</span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="vec.perm.html">vec.perm</a></span><span class="op">(</span><span class="va">n_stages</span>, <span class="va">n_patches</span>, <span class="va">group_by</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Demographic parameter values</span></span></span>
<span class="r-in"><span><span class="co"># Northern</span></span></span>
<span class="r-in"><span><span class="va">f11</span> <span class="op">&lt;-</span> <span class="fl">0.00</span>  <span class="co"># only adults reproduce</span></span></span>
<span class="r-in"><span><span class="va">f12</span> <span class="op">&lt;-</span> <span class="fl">0.26</span></span></span>
<span class="r-in"><span><span class="va">s11</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span></span>
<span class="r-in"><span><span class="va">s12</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></span>
<span class="r-in"><span><span class="co"># Southern</span></span></span>
<span class="r-in"><span><span class="va">f21</span> <span class="op">&lt;-</span> <span class="fl">0.00</span></span></span>
<span class="r-in"><span><span class="va">f22</span> <span class="op">&lt;-</span> <span class="fl">0.19</span></span></span>
<span class="r-in"><span><span class="va">s21</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span></span>
<span class="r-in"><span><span class="va">s22</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Demography matrices for patches</span></span></span>
<span class="r-in"><span><span class="va">B1x</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f11</span>, <span class="va">f12</span>, <span class="va">s11</span>, <span class="va">s12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         nrow <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">B2x</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f21</span>, <span class="va">f22</span>, <span class="va">s21</span>, <span class="va">s22</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         nrow <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Demography block matrix construction</span></span></span>
<span class="r-in"><span><span class="va">BB</span> <span class="op">&lt;-</span> <span class="fu"><a href="blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">B1x</span>, <span class="va">B2x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Movement parameter values</span></span></span>
<span class="r-in"><span><span class="va">dx1</span> <span class="op">&lt;-</span> <span class="fl">0.27</span>  <span class="co"># only juveniles disperse</span></span></span>
<span class="r-in"><span><span class="va">dx2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">dx1</span></span></span>
<span class="r-in"><span><span class="co"># Movement matrices for stages</span></span></span>
<span class="r-in"><span><span class="va">Mx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dx2</span>, <span class="va">dx1</span>, <span class="va">dx1</span>, <span class="va">dx2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_patches</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Mx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">n_patches</span>, ncol <span class="op">=</span> <span class="va">n_patches</span><span class="op">)</span>  <span class="co"># no Movement by adults</span></span></span>
<span class="r-in"><span><span class="co"># Movement block matrix construction</span></span></span>
<span class="r-in"><span><span class="va">MM</span> <span class="op">&lt;-</span> <span class="fu"><a href="blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Mx1</span>, <span class="va">Mx2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Arrangement by patches</span></span></span>
<span class="r-in"><span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span></span>
<span class="r-in"><span><span class="co"># Assumed movement before demography</span></span></span>
<span class="r-in"><span><span class="va">lh_order</span> <span class="op">&lt;-</span> <span class="st">"move"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Projection matrix construction</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="spmm.project.matrix.html">spmm.project.matrix</a></span><span class="op">(</span>P <span class="op">=</span> <span class="va">P</span>, BB <span class="op">=</span> <span class="va">BB</span>, MM <span class="op">=</span> <span class="va">MM</span>,</span></span>
<span class="r-in"><span>group_by <span class="op">=</span> <span class="va">group_by</span>, lh_order <span class="op">=</span> <span class="va">lh_order</span><span class="op">)</span>  <span class="co"># BB %*% t(P) %*% MM %*% P</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Initial stages within patches (patch group_by)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">50</span>, <span class="fl">22</span>,  <span class="co"># Northern patch adults and juveniles</span></span></span>
<span class="r-in"><span>  <span class="fl">40</span>, <span class="fl">17</span>   <span class="co"># Southern patch adults and juveniles</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/comment.html" class="external-link">comment</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"patches"</span>  <span class="co"># vec comment attr for group_by</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Number of time steps to project into the future</span></span></span>
<span class="r-in"><span><span class="va">n_timesteps</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Project spatial matrix population model</span></span></span>
<span class="r-in"><span><span class="va">projs</span> <span class="op">&lt;-</span> <span class="fu">spmm.project</span><span class="op">(</span><span class="va">n</span>, <span class="va">A</span>, <span class="va">n_timesteps</span>, <span class="va">n_stages</span>, <span class="va">n_patches</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in spmm.project(n, A, n_timesteps, n_stages, n_patches) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   object 'group_by' not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Deterministic spatial matrix model projections for patches structured population vector and movement then demography A projection matrix."</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Caleb A. Aldrdge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

