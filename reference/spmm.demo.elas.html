<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates the sensitivity or elasticity of lambda to changes in the 
demographic and movement (dispersal) black matrices as described in Hunter and 
Caswell (2005) and Lebreton (1996)."><title>elasticity of demographic block matrices — spmm.demo.elas • metapopbio</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="elasticity of demographic block matrices — spmm.demo.elas"><meta property="og:description" content="Calculates the sensitivity or elasticity of lambda to changes in the 
demographic and movement (dispersal) black matrices as described in Hunter and 
Caswell (2005) and Lebreton (1996)."><meta property="og:image" content="https://aldridgecaleb.github.io/meta-pop-bio/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metapopbio</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting-started.html">Getting started with the metapopbio package</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AldridgeCaleb/meta-pop-bio/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>elasticity of demographic block matrices</h1>
      <small class="dont-index">Source: <a href="https://github.com/AldridgeCaleb/meta-pop-bio/blob/HEAD/R/spmm.demo.elas.R" class="external-link"><code>R/spmm.demo.elas.R</code></a></small>
      <div class="d-none name"><code>spmm.demo.elas.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the sensitivity or elasticity of lambda to changes in the 
demographic and movement (dispersal) black matrices as described in Hunter and 
Caswell (2005) and Lebreton (1996).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spmm.demo.elas</span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>BB</dt>
<dd><p>The block diagonal demographics matrix (see `blk.diag` function).</p></dd>


<dt>A</dt>
<dd><p>The spatial population projection matrix constructed from the
vec-permutation matrix P, block diagonal demographic matrix BB, and 
block diagonal movement matrix MM (see `spmm.project.matrix` for more details).</p></dd>


<dt>P</dt>
<dd><p>The vec-permutation matrix (see `vec.perm` function).</p></dd>


<dt>MM</dt>
<dd><p>The block diagonal movement matrix (see `blk.diag` function).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix containing sensitivity values for the projection matrix A.
According to Morris and Doak (2003) sensitivity values od lambda for a 
particular matrix element is "directly proportional to the fraction of 
individuals in the population on which the element will act times the future 
value of each individual that the element 'creates'" (p. 226).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Ensure that the structural types of population vector `n` and projection 
matrix `A` are the same. Otherwise, projections may produce incorrect values!</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988). The New S Language. 
Wadsworth &amp; Brooks/Cole.</p>
<p>Wootton, J.T., and Bell, D.A. (1992). A metapopulation model of the peregrine 
falcon in California: viability and management strategies. Ecological 
Applications 2:307--321.</p>
<p>Lebreton, J. D. (1996). Demographic models for subdivided populations: the 
renewal equation approach. Theoretical Population Biology 49:291--313.</p>
<p>Caswell, H. (2001). Matrix Population Models: Construction, analysis, and 
interpretation (2nd ed.). Sinauer Associates.</p>
<p>Morris, W. F., and Doak, D. F. (2003). Quantitative Conservation Biology: 
Theory and practice of population viability analysis. Sinauer Associates.</p>
<p>Hunter, C. M. and Caswell, H. (2005). The use of vec-permutation matrix in
spatial matrix population models. Ecological Modelling 188:15--21.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Peregrine falcon example from Hunter and Caswell (2005), data from Wootton</span></span></span>
<span class="r-in"><span><span class="co"># and Bell (1992). Continues example from `spmm.project.matrix`.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the number of patches and stages</span></span></span>
<span class="r-in"><span><span class="va">n_patches</span> <span class="op">&lt;-</span> <span class="fl">2</span>  <span class="co"># northern = 1x; southern = 2x</span></span></span>
<span class="r-in"><span><span class="va">n_stages</span> <span class="op">&lt;-</span> <span class="fl">2</span>  <span class="co"># juvenile = x1; adult = x2</span></span></span>
<span class="r-in"><span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Construct vec-permutation matrix</span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="vec.perm.html">vec.perm</a></span><span class="op">(</span><span class="va">n_stages</span>, <span class="va">n_patches</span>, <span class="va">group_by</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Demographic parameter values</span></span></span>
<span class="r-in"><span><span class="co"># Northern</span></span></span>
<span class="r-in"><span><span class="va">f11</span> <span class="op">&lt;-</span> <span class="fl">0.00</span>  <span class="co"># only adults reproduce</span></span></span>
<span class="r-in"><span><span class="va">f12</span> <span class="op">&lt;-</span> <span class="fl">0.26</span></span></span>
<span class="r-in"><span><span class="va">s11</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span></span>
<span class="r-in"><span><span class="va">s12</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></span>
<span class="r-in"><span><span class="co"># Southern</span></span></span>
<span class="r-in"><span><span class="va">f21</span> <span class="op">&lt;-</span> <span class="fl">0.00</span></span></span>
<span class="r-in"><span><span class="va">f22</span> <span class="op">&lt;-</span> <span class="fl">0.19</span>  </span></span>
<span class="r-in"><span><span class="va">s21</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span></span>
<span class="r-in"><span><span class="va">s22</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Demography matrices for patches</span></span></span>
<span class="r-in"><span><span class="va">B1x</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f11</span>, <span class="va">f12</span>, <span class="va">s11</span>, <span class="va">s12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         nrow <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">B2x</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f21</span>, <span class="va">f22</span>, <span class="va">s21</span>, <span class="va">s22</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         nrow <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Demography block matrix construction</span></span></span>
<span class="r-in"><span><span class="va">BB</span> <span class="op">&lt;-</span> <span class="fu"><a href="blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="va">B1x</span>, <span class="va">B2x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Movement parameter values</span></span></span>
<span class="r-in"><span><span class="va">dx1</span> <span class="op">&lt;-</span> <span class="fl">0.27</span>  <span class="co"># only juveniles disperse</span></span></span>
<span class="r-in"><span><span class="va">dx2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">dx1</span></span></span>
<span class="r-in"><span><span class="co"># Movement matrices for stages</span></span></span>
<span class="r-in"><span><span class="va">Mx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dx2</span>, <span class="va">dx1</span>, <span class="va">dx1</span>, <span class="va">dx2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_patches</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Mx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">n_patches</span>, ncol <span class="op">=</span> <span class="va">n_patches</span><span class="op">)</span>  <span class="co"># no movement by adults</span></span></span>
<span class="r-in"><span><span class="co"># Movement block matrix construction</span></span></span>
<span class="r-in"><span><span class="va">MM</span> <span class="op">&lt;-</span> <span class="fu"><a href="blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="va">Mx1</span>, <span class="va">Mx2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Arrangement by patches</span></span></span>
<span class="r-in"><span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span></span>
<span class="r-in"><span><span class="co"># Assumed movement before demography</span></span></span>
<span class="r-in"><span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"move"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Projection matrix construction</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="spmm.project.matrix.html">spmm.project.matrix</a></span><span class="op">(</span><span class="va">P</span>, <span class="va">BB</span>, <span class="va">MM</span>, <span class="va">group_by</span>, <span class="va">type</span><span class="op">)</span>  <span class="co"># BB %*% t(P) %*% MM %*% P </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate sensitivity of lambda to elements of block deomgraphic matrix BB</span></span></span>
<span class="r-in"><span><span class="va">BB_sens</span> <span class="op">&lt;-</span> <span class="fu"><a href="spmm.demo.sens.html">spmm.demo.sens</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">BB_elas</span> <span class="op">&lt;-</span> <span class="fu">spmm.demo.elas</span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate sensitivity of lambda to elements of block movement matrix MM</span></span></span>
<span class="r-in"><span><span class="va">MM_sens</span> <span class="op">&lt;-</span> <span class="fu"><a href="spmm.move.sens.html">spmm.move.sens</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MM_elas</span> <span class="op">&lt;-</span> <span class="fu"><a href="spmm.move.elas.html">spmm.move.elas</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">BB</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate sensitivity of lambda to specific movement probability</span></span></span>
<span class="r-in"><span><span class="va">sens_d</span> <span class="op">&lt;-</span> <span class="va">MM_sens</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">MM_sens</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">MM_sens</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">MM_sens</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Caleb A. Aldrdge.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

