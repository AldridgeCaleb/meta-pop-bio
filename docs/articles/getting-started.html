<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metapopbio">
<title>Getting started with the `metapopbio` package • metapopbio</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with the `metapopbio` package">
<meta property="og:description" content="metapopbio">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metapopbio</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting-started.html">Getting started with the `metapopbio` package</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AldridgeCaleb/meta-pop-bio/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting started with the `metapopbio` package</h1>
                        <h4 data-toc-skip class="author">Caleb A.
Aldridge</h4>
            
            <h4 data-toc-skip class="date">2023-09-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AldridgeCaleb/meta-pop-bio/blob/HEAD/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github("AldridgeCaleb/meta-pop-bio")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">metapopbio</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>The <a href="https://github.com/AldridgeCaleb/meta-pop-bio" class="external-link"><code>metapopbio</code></a>
package is inspired by and complements the fuctionalities of the <a href="https://cran.r-project.org/web/packages/popbio/index.html" class="external-link"><code>popbio</code></a>
package. Users can construct and analyze projection matrix models for
metapopulations classified by age or stage and located in distinct
patches.</p>
<p>The functionality to date is largely based on Hunter and Caswell
(2005) to construct and analyze spatial matrix population models using
the vec-permutation matrix. This model extends the Leslie matrix (Leslie
1945) to include dispersal rates between patches. An analogous approach
was taken by Lebreton (1996) and called the “renewal equation
approach.”</p>
<p>Current plans include support for classic metapopulation models of
Gotelli (1991; 2008) <em>and others</em>, i.e., <span class="math inline">\(\frac{df}{dt}=p_{i}(1-f)-p_{e}f\)</span>, <span class="math inline">\(\frac{df}{dt}=p_{i}(1-f)-ef(1-f)\)</span>, <span class="math inline">\(\frac{df}{dt}=if(1-f)-p_{e}f\)</span>, and <span class="math inline">\(\frac{df}{dt}=if(1-f)-ef(1-f)\)</span>, and
hyperstate matrix models (Roth and Caswell 2016). Additionally, Hanski’s
(1994) incidence function <span class="math inline">\(J_{i}=\frac{1}{1+\Bigl(1+\bigl[\frac{y'}{S_{i}}\bigr]^2\Bigr)\frac{e}{A_{i}^x}}\)</span>
and a metapopulation version of the
<strong>S</strong>usceptible–<strong>I</strong>nfected–<strong>R</strong>ecovered
model (SIR model) are also being considered. Other suggestions can be
submitted in email to <a href="mailto:caleb.a.aldridge@gmail.com" class="email">caleb.a.aldridge@gmail.com</a> or as an issue on the
package’s GitHub repository (<a href="https://github.com/AldridgeCaleb/meta-pop-bio/issues" class="external-link uri">https://github.com/AldridgeCaleb/meta-pop-bio/issues</a>).</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The following two examples come from Hunter and Caswell (2005) using
peregrine falcon (<em>Falco peregrinus</em>) data from Wootton and Bell
(1992) and black-headed gull (<em>Larus ridibundus</em>) data from
Lebrenton (1996).</p>
<div class="section level3">
<h3 id="the-peregrine-falcon">The peregrine falcon<a class="anchor" aria-label="anchor" href="#the-peregrine-falcon"></a>
</h3>
<div class="section level5">
<h5 id="patches-stages-and-grouping">1. Patches, stages, and grouping<a class="anchor" aria-label="anchor" href="#patches-stages-and-grouping"></a>
</h5>
<p>First, we define the number of patches (discrete locations) and
stages (age, class, or size). In this example there are two “patches”,
Northern California and Southern California, and two life-stages,
juvenile and adult. We also group or will project stages within
patches<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;If we were to group or project patches within stages,
the groupby object would contain “stages”.&lt;/p&gt;"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_patches</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">n_stages</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-vec-permutation-matrix">2. Construct vec-permutation matrix<a class="anchor" aria-label="anchor" href="#construct-vec-permutation-matrix"></a>
</h5>
<p>Next, we construct the vec-permutation matrix. Essentially, the
vec-permutation matrix helps us relate demographic and dispersal
parameters so that populations in patches are projected considering
births, immigration, deaths, and emigration (BIDE) or recruitment,
immigration, survival, and emigration (RISE). The
<code><a href="../reference/vec.perm.html">metapopbio::vec.perm</a></code> function helps us to easily construct
a vec-permutation matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">P</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/vec.perm.html">vec.perm</a></span><span class="op">(</span>stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>           patches <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>           group_by <span class="op">=</span> <span class="va">group_by</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    1    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="demographic-parameters-for-each-patch">3. Demographic parameters for each patch<a class="anchor" aria-label="anchor" href="#demographic-parameters-for-each-patch"></a>
</h5>
<p>We now specify transition probabilities from one stage to the next
(survival <em>s</em> and recruitment <em>r</em>). Numbers in object
names indicate patch then stage. Only adults are assumed to
reproduce.</p>
<p>Northern first.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Northern</span></span>
<span><span class="va">r11</span> <span class="op">&lt;-</span> <span class="fl">0.00</span> </span>
<span><span class="va">r12</span> <span class="op">&lt;-</span> <span class="fl">0.26</span></span>
<span><span class="va">s11</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span>
<span><span class="va">s12</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></code></pre></div>
<p>Now Southern.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Southern</span></span>
<span><span class="va">r21</span> <span class="op">&lt;-</span> <span class="fl">0.00</span></span>
<span><span class="va">r22</span> <span class="op">&lt;-</span> <span class="fl">0.19</span>  </span>
<span><span class="va">s21</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span>
<span><span class="va">s22</span> <span class="op">&lt;-</span> <span class="fl">0.77</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="a--structure-demographic-parameters">4a. Structure demographic parameters<a class="anchor" aria-label="anchor" href="#a--structure-demographic-parameters"></a>
</h5>
<p>Now we will construct demographic (Leslise-style) matrices for each
of the patches. This is just placing the demographic parameters from
above into an ordered matrices for analysis and projecting.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Northern</span></span>
<span><span class="op">(</span><span class="va">B1x</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r11</span>, <span class="va">r12</span>, <span class="va">s11</span>, <span class="va">s12</span><span class="op">)</span>,</span>
<span>         nrow <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         ncol <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.26</span></span>
<span><span class="co">#&gt; [2,] 0.72 0.77</span></span>
<span><span class="co"># Southern</span></span>
<span><span class="op">(</span><span class="va">B2x</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r21</span>, <span class="va">r22</span>, <span class="va">s21</span>, <span class="va">s22</span><span class="op">)</span>,</span>
<span>         nrow <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         ncol <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.19</span></span>
<span><span class="co">#&gt; [2,] 0.72 0.77</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="b--construct-block-diagonal-matrix">4b. Construct block diagonal matrix<a class="anchor" aria-label="anchor" href="#b--construct-block-diagonal-matrix"></a>
</h5>
<p>Along with the vec-permutation matrix, spatial matrix population
models use a matrix of matrices for analysis and projection of
population demographics and movement. We accomplish this using the
<code><a href="../reference/blk.diag.html">metapopbio::blk.diag</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">BB</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="va">B1x</span>, <span class="va">B2x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.26 0.00 0.00</span></span>
<span><span class="co">#&gt; [2,] 0.72 0.77 0.00 0.00</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.00 0.00 0.19</span></span>
<span><span class="co">#&gt; [4,] 0.00 0.00 0.72 0.77</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="structure-movement-parameters">5. Structure movement parameters<a class="anchor" aria-label="anchor" href="#structure-movement-parameters"></a>
</h5>
<p>Similar to the above, we will construct movement or dispersal
matrices for each of the stages. This is just placing movement
parameters into an ordered matrices for analysis and projecting. We
assume that only juveniles disperse, therefore an idenity matrix is
specified for adult movement.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Juveniles</span></span>
<span><span class="va">dx1</span> <span class="op">&lt;-</span> <span class="fl">0.27</span> </span>
<span><span class="va">dx2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">dx1</span></span>
<span><span class="op">(</span><span class="va">Mx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dx2</span>, <span class="va">dx1</span>, <span class="va">dx1</span>, <span class="va">dx2</span><span class="op">)</span>,</span>
<span>              nrow <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>              ncol <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>              byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.73 0.27</span></span>
<span><span class="co">#&gt; [2,] 0.27 0.73</span></span>
<span><span class="co"># Adults</span></span>
<span><span class="op">(</span><span class="va">Mx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">n_patches</span>,</span>
<span>  ncol <span class="op">=</span> <span class="va">n_patches</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    0</span></span>
<span><span class="co">#&gt; [2,]    0    1</span></span>
<span><span class="co"># Block diagonal matrix</span></span>
<span><span class="op">(</span><span class="va">MM</span> <span class="op">&lt;-</span> <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/blk.diag.html">blk.diag</a></span><span class="op">(</span><span class="va">Mx1</span>, <span class="va">Mx2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.73 0.27    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.27 0.73    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.00    1    0</span></span>
<span><span class="co">#&gt; [4,] 0.00 0.00    0    1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="construct-projection-matrix">6. Construct projection matrix<a class="anchor" aria-label="anchor" href="#construct-projection-matrix"></a>
</h5>
<p>Now we can use the vec-permutation matrix and block diagonal matrices
to construct a population projection matrix. This is accomplished
through matrix multiplication. The order of matrices is very important
(see Hunter and Caswell 2005 or function documentation for more detail),
but the <code><a href="../reference/meta.pop.A.html">metapopbio::meta.pop.A</a></code> function makes it much more
convenient and reduces the probability of calculation errors. All that’s
needed is to specify the grouping (structure) for the projection (stages
within patches here) and the order type between demographic and movement
/ dispersal processes (here, dispersal then deomgraphics), then supply
the matrices we have constructed (P, BB, and MM).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_by</span> <span class="op">&lt;-</span> <span class="st">"patches"</span></span>
<span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"move"</span></span>
<span><span class="op">(</span><span class="va">A</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/meta.pop.A.html">meta.pop.A</a></span><span class="op">(</span></span>
<span>    P <span class="op">=</span> <span class="va">P</span>,</span>
<span>    BB <span class="op">=</span> <span class="va">BB</span>,</span>
<span>    MM <span class="op">=</span> <span class="va">MM</span>,</span>
<span>    group_by <span class="op">=</span> <span class="va">group_by</span>,</span>
<span>    type <span class="op">=</span> <span class="va">type</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1] [,2]   [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.0000 0.26 0.0000 0.00</span></span>
<span><span class="co">#&gt; [2,] 0.5256 0.77 0.1944 0.00</span></span>
<span><span class="co">#&gt; [3,] 0.0000 0.00 0.0000 0.19</span></span>
<span><span class="co">#&gt; [4,] 0.1944 0.00 0.5256 0.77</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="project">7. Project<a class="anchor" aria-label="anchor" href="#project"></a>
</h5>
<p>Now we can project populations into future time steps. First, we have
to indicate the starting, initial, or current sizes of each stage by
patch, or vice versa if grouping by stages. An added step is to comment
on the vector which ensures projection calculations are correct.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">50</span>, <span class="fl">22</span>,  <span class="co"># Northern patch adults then juveniles</span></span>
<span>  <span class="fl">40</span>, <span class="fl">17</span>   <span class="co"># Southern patch adults then juveniles</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/comment.html" class="external-link">comment</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"patches"</span>  <span class="co"># vector attr for group_by </span></span></code></pre></div>
<p>Now we indicate the number of time steps we would like to
project.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_timesteps</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></code></pre></div>
<p>And, finally we can project stages within patches using the
<code><a href="../reference/meta.pop.proj.html">metapopbio::meta.pop.proj</a></code> function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span></span>
<span>  <span class="va">projs</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/meta.pop.proj.html">meta.pop.proj</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="va">n</span>,</span>
<span>      A <span class="op">=</span> <span class="va">A</span>,</span>
<span>      n_timesteps <span class="op">=</span> <span class="va">n_timesteps</span>,</span>
<span>      n_stages <span class="op">=</span> <span class="va">n_stages</span>,</span>
<span>      n_patches <span class="op">=</span> <span class="va">n_patches</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Deterministic spatial matrix model projections for patches structured population vector and movement then demography A projection matrix."</span></span>
<span><span class="co">#&gt;       1      2        3         4         5         6         7         8</span></span>
<span><span class="co">#&gt; [1,] 50  5.720 13.25896 11.154329 10.821703 10.208134  9.676265  9.161220</span></span>
<span><span class="co">#&gt; [2,] 22 50.996 42.90126 41.621935 39.262053 37.216402 35.235463 33.358700</span></span>
<span><span class="co">#&gt; [3,] 40  3.230  8.32846  6.946749  6.670443  6.241967  5.872162  5.521961</span></span>
<span><span class="co">#&gt; [4,] 17 43.834 36.56184 35.107594 32.852460 30.906118 29.062950 27.345946</span></span>
<span><span class="co">#&gt;              9        10        11        12        13        14        15</span></span>
<span><span class="co">#&gt; [1,]  8.673262  8.209449  7.769142  7.351297  6.954951  6.579141  6.222929</span></span>
<span><span class="co">#&gt; [2,] 31.574806 29.881317 28.274221 26.749810 25.304389 23.934343 22.636151</span></span>
<span><span class="co">#&gt; [3,]  5.195730  4.890536  4.604935  4.337412  4.086636  3.851388  3.630565</span></span>
<span><span class="co">#&gt; [4,] 25.739662 24.236498 22.828486 21.508609 20.270465 19.108236 18.016617</span></span>
<span><span class="co">#&gt;             16        17        18        19       20        21        22</span></span>
<span><span class="co">#&gt; [1,]  5.885399  5.565661  5.262854  4.976147  4.70474  4.447862  4.204778</span></span>
<span><span class="co">#&gt; [2,] 21.406390 20.241748 19.139028 18.095152 17.10716 16.172222 15.287615</span></span>
<span><span class="co">#&gt; [3,]  3.423157  3.228244  3.044981  2.872594  2.71037  2.557653  2.413835</span></span>
<span><span class="co">#&gt; [4,] 16.990757 16.026216 15.118916 14.265106 13.46133 12.704396 11.991352</span></span>
<span><span class="co">#&gt;             23        24        25        26        27        28        29</span></span>
<span><span class="co">#&gt; [1,]  3.974780  3.757194  3.551374  3.356706  3.172603  2.998508  2.833890</span></span>
<span><span class="co">#&gt; [2,] 14.450744 13.659130 12.910407 12.202320 11.532725 10.899578 10.300941</span></span>
<span><span class="co">#&gt; [3,]  2.278357  2.150698  2.030376  1.916942  1.809980  1.709102  1.613943</span></span>
<span><span class="co">#&gt; [4,] 11.319461 10.686187 10.089169  9.526213  8.995272  8.494439  8.021932</span></span>
<span><span class="co">#&gt;            30       31       32       33       34       35       36       37</span></span>
<span><span class="co">#&gt; [1,] 2.678245 2.531092 2.391976 2.260466 2.136152 2.018645 1.907577 1.802598</span></span>
<span><span class="co">#&gt; [2,] 9.734968 9.199909 8.694102 8.215971 7.764021 7.336835 6.933070 6.551456</span></span>
<span><span class="co">#&gt; [3,] 1.524167 1.439456 1.359514 1.284064 1.212846 1.145616 1.082145 1.022218</span></span>
<span><span class="co">#&gt; [4,] 7.576085 7.155338 6.758233 6.383400 6.029557 5.695499 5.380094 5.082281</span></span>
<span><span class="co">#&gt;             38        39        40        41        42        43        44</span></span>
<span><span class="co">#&gt; [1,] 1.7033785 1.6096043 1.5209792 1.4372223 1.3580681 1.2832649 1.2125748</span></span>
<span><span class="co">#&gt; [2,] 6.1907857 5.8499199 5.5277782 5.2233387 4.9356341 4.6637491 4.4068179</span></span>
<span><span class="co">#&gt; [3,] 0.9656334 0.9122012 0.8617429 0.8140905 0.7690857 0.7265795 0.6864318</span></span>
<span><span class="co">#&gt; [4,] 4.8010591 4.5354892 4.2846867 4.0478192 3.8241028 3.6127990 3.4132121</span></span>
<span><span class="co">#&gt;             45        46        47        48        49        50</span></span>
<span><span class="co">#&gt; [1,] 1.1457726 1.0826456 1.0229921 0.9666217 0.9133544 0.8630197</span></span>
<span><span class="co">#&gt; [2,] 4.1640214 3.9345850 3.7177760 3.5129015 3.3193064 3.1363713</span></span>
<span><span class="co">#&gt; [3,] 0.6485103 0.6126904 0.5788547 0.5468924 0.5166992 0.4881764</span></span>
<span><span class="co">#&gt; [4,] 3.2246864 3.0466038 2.8783813 2.7194693 2.5693493 2.4275321</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="plotting">8. Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h5>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stage_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Juv."</span>, <span class="st">"Adults"</span><span class="op">)</span></span>
<span><span class="va">patch_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"North"</span>, <span class="st">"South"</span><span class="op">)</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/meta.pop.plot.html">meta.pop.plot</a></span><span class="op">(</span></span>
<span>  projections <span class="op">=</span> <span class="va">projs</span>,</span>
<span>  ylabs <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>  xlabs <span class="op">=</span> <span class="st">"Years"</span>,</span>
<span>  stage_names <span class="op">=</span> <span class="va">stage_names</span>,</span>
<span>  patch_names <span class="op">=</span> <span class="va">patch_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="sensitivity-and-elasticity-analyses">9. Sensitivity and elasticity analyses<a class="anchor" aria-label="anchor" href="#sensitivity-and-elasticity-analyses"></a>
</h5>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/sens.A.html">sens.A</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]      [,2]       [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.10867018 0.3949167 0.06141440 0.3054113</span></span>
<span><span class="co">#&gt; [2,] 0.16158007 0.5871958 0.09131616 0.4541115</span></span>
<span><span class="co">#&gt; [3,] 0.08404076 0.3054113 0.04749521 0.2361917</span></span>
<span><span class="co">#&gt; [4,] 0.09131616 0.3318507 0.05160687 0.2566388</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/eigen.lambda.html">eigen.lambda</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt; $eig</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1]  0.94486220  0.85353422 -0.17486220 -0.08353422</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;           [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.2111729 -0.1455690 -0.6997575  0.5681052</span></span>
<span><span class="co">#&gt; [2,] 0.7674202 -0.4778775  0.4706197 -0.1825239</span></span>
<span><span class="co">#&gt; [3,] 0.1193433  0.1882302 -0.3954644 -0.7345971</span></span>
<span><span class="co">#&gt; [4,] 0.5934892  0.8455839  0.3639567  0.3229684</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda</span></span>
<span><span class="co">#&gt; [1] 0.9448622</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $v</span></span>
<span><span class="co">#&gt; [1] 0.2111729 0.7674202 0.1193433 0.5934892</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $eig_t</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1]  0.94486220  0.85353422 -0.17486220 -0.08353422</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] -0.4706197 -0.1825239 -0.7674202 -0.4778775</span></span>
<span><span class="co">#&gt; [2,] -0.6997575 -0.5681052  0.2111729  0.1455690</span></span>
<span><span class="co">#&gt; [3,] -0.3639567  0.3229684 -0.5934892  0.8455839</span></span>
<span><span class="co">#&gt; [4,] -0.3954644  0.7345971  0.1193433 -0.1882302</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $w</span></span>
<span><span class="co">#&gt; [1] -0.4706197 -0.6997575 -0.3639567 -0.3954644</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/sens.BB.html">sens.BB</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.10202024 0.16158007 0.09069071 0.09131616</span></span>
<span><span class="co">#&gt; [2,] 0.37075026 0.58719578 0.32957777 0.33185072</span></span>
<span><span class="co">#&gt; [3,] 0.05765622 0.09131616 0.05125339 0.05160687</span></span>
<span><span class="co">#&gt; [4,] 0.28672202 0.45411152 0.25488102 0.25663882</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/elas.BB.html">elas.BB</a></span><span class="op">(</span><span class="va">BB</span>, <span class="va">A</span>, <span class="va">P</span>, <span class="va">MM</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]       [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.0000000 0.04446238 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,] 0.2825176 0.47852560 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [3,] 0.0000000 0.00000000 0.0000000 0.0103775</span></span>
<span><span class="co">#&gt; [4,] 0.0000000 0.00000000 0.1942234 0.2091436</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/sens.MM.html">sens.MM</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">P</span>, <span class="va">A</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]       [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0 0.00000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,]    0    0 0.02659392 0.1077754</span></span>
<span><span class="co">#&gt; [3,]    0    0 0.02779700 0.1126510</span></span>
<span><span class="co">#&gt; [4,]    0    0 0.18455308 0.7479256</span></span>
<span><span class="fu">metapopbio</span><span class="fu">::</span><span class="fu"><a href="../reference/elas.MM.html">elas.MM</a></span><span class="op">(</span><span class="va">MM</span>, <span class="va">P</span>, <span class="va">A</span>, <span class="va">BB</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]     [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,]    0    0 0.000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,]    0    0 0.000000 0.0000000</span></span>
<span><span class="co">#&gt; [3,]    0    0 0.027797 0.0000000</span></span>
<span><span class="co">#&gt; [4,]    0    0 0.000000 0.7479256</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="the-black-headed-gull">The black-headed gull<a class="anchor" aria-label="anchor" href="#the-black-headed-gull"></a>
</h3>
<!-- n_stages <- 5 -->
<!-- n_patches <- 2 -->
<!-- structure <- "stages"  # group by stages -->
<!-- type <- "disp"  # dispersal then demographics -->
<!-- B1x <- matrix(c(0.000, 0.096, 0.160, 0.224, 0.320, -->
<!--                 0.800, 0.000, 0.000, 0.000, 0.000, -->
<!--                 0.000, 0.820, 0.000, 0.000, 0.000, -->
<!--                 0.000, 0.000, 0.820, 0.000, 0.000, -->
<!--                 0.000, 0.000, 0.000, 0.820, 0.820),  -->
<!--               nrow = n_stages, ncol = n_stages, byrow = TRUE) -->
<!-- B2x <- matrix(c(0.000, 0.100, 0.160, 0.200, 0.200, -->
<!--                 0.800, 0.000, 0.000, 0.000, 0.000, -->
<!--                 0.000, 0.820, 0.000, 0.000, 0.000, -->
<!--                 0.000, 0.000, 0.820, 0.000, 0.000, -->
<!--                 0.000, 0.000, 0.000, 0.820, 0.820),  -->
<!--               nrow = n_stages, ncol = n_stages, byrow = TRUE) -->
<!-- Mx1 <- matrix(c(0.75, 0.375, 0.25, 0.625),  -->
<!--               nrow = n_patches, ncol = n_patches, byrow = TRUE) -->
<!-- Mx5 <- Mx4 <- Mx3 <- Mx2 <-  -->
<!--   diag(x = 1, nrow = n_patches, ncol = n_patches, byrow = TRUE) -->
<!-- P <- vec.perm(stages = n_stages, -->
<!--               patches = n_patches, -->
<!--               n_struc = structure) -->
<!-- A <- meta.pop.A(P, BB, MM, n_struc = structure, type = type) -->
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Caswell, H. (2001). Matrix Population Models: Construction, analysis,
and interpretation (2nd ed.). Sinauer Associates.</p>
<p>Gotelli, N. J. (1991). Metapopulation models: the rescue effect, the
propagule rain, and the core-satellite hypothesis. <em>The American
Naturalist</em> 138(3):768–776. url: <a href="https://www.jstor.org/stable/2462468" class="external-link uri">https://www.jstor.org/stable/2462468</a></p>
<p>Gotelli, N. J. (2008). A Primer of Ecology (4th ed.). Sinauer
Associates.</p>
<p>Hunter, C. M. and Caswell, H. (2005). The use of vec-permutation
matrix in spatial matrix population models. <em>Ecological
Modelling</em> 188:15–21.</p>
<p>Lebreton, J. D. (1996). Demographic models for subdivided
populations: the renewal equation approach. <em>Theoretical Population
Biology</em> 49:291–313.</p>
<p>Leslie, P. H. (1945). On the use of matrices in certain population
mathematics. <em>Biometrika</em> 33:183–212.</p>
<p>Morris, W. F., and Doak, D. F. (2003). Quantitative Conservation
Biology: Theory and practice of population viability analysis. Sinauer
Associates.</p>
<p>Roth, G. and Caswell, H. (2016). Hyperstate matrix models: extending
demographic state spaces to higher dimensions. <em>Methods in Ecology
and Evolution</em> 7:1438–1450.</p>
<p>Wootton, J.T., and Bell, D.A. (1992). A metapopulation model of the
peregrine falcon in California: viability and management strategies.
<em>Ecological Applications</em> 2:307-–321.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Caleb A. Aldrdge.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
